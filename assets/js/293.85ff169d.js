(window.webpackJsonp=window.webpackJsonp||[]).push([[293],{483:function(t,a,s){"use strict";s.r(a);var e=s(0),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"ajax-如何预防csrf"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax-如何预防csrf"}},[t._v("#")]),t._v(" AJAX - 如何预防CSRF")]),t._v(" "),s("blockquote",[s("p",[t._v("前世今生解惑")])]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#ajax---%E5%A6%82%E4%BD%95%E9%A2%84%E9%98%B2csrf"}},[t._v("AJAX - 如何预防CSRF")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#ajax%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A"}},[t._v("AJAX名词解释")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#ajax%E9%83%A8%E5%88%86%E5%B1%9E%E6%80%A7"}},[t._v("AJAX部分属性")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#ajax%E5%B0%81%E8%A3%85"}},[t._v("AJAX封装")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#ajax%E9%A2%84%E9%98%B2csrfg"}},[t._v("AJAX预防CSRFG")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#ajax%E8%B5%84%E6%BA%90%E5%9B%9E%E6%94%B6"}},[t._v("AJAX资源回收")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#ftech"}},[t._v("Ftech")])])])])]),t._v(" "),s("h2",{attrs:{id:"ajax名词解释"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax名词解释"}},[t._v("#")]),t._v(" AJAX名词解释")]),t._v(" "),s("p",[t._v("AJAX = "),s("strong",[t._v("A")]),t._v("synchronous"),s("strong",[t._v("Ja")]),t._v("vascript+"),s("strong",[t._v("X")]),t._v("ML")]),t._v(" "),s("p",[t._v("关键词解析："),s("strong",[t._v("异步的、和JavaScript相关、XML")])]),t._v(" "),s("p",[t._v("前两个很好理解，因为"),s("code",[t._v("AJAX")]),t._v("使用场景就是改变页面的部分数据。")]),t._v(" "),s("p",[t._v("最后一个和它创建对象有关，我们是通过一个"),s("code",[t._v("new XMLHttpRequest()")]),t._v("对象（IE浏览器可能有新的名字）来创建一个对象，我们可以叫他"),s("code",[t._v("AJAX")]),t._v("。")]),t._v(" "),s("p",[t._v("所以"),s("code",[t._v("AJAX")]),t._v("是多种技术融合，通过"),s("code",[t._v("XMLHttpRequest")]),t._v("请求数据，通过"),s("code",[t._v("js and html css")]),t._v("来改变页面。")]),t._v(" "),s("p",[s("code",[t._v("XMLHttpRequest")]),t._v("是核心，就像是下面这样：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadXMLDoc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" xmlhttp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("XMLHttpRequest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//  IE7+, Firefox, Chrome, Opera, Safari 浏览器执行代码")]),t._v("\n\t\txmlhttp"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// IE6, IE5 浏览器执行代码")]),t._v("\n\t\txmlhttp"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ActiveXObject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Microsoft.XMLHTTP"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\txmlhttp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onreadystatechange")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xmlhttp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" xmlhttp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tdocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myDiv"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xmlhttp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseText"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\txmlhttp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/try/ajax/ajax_info.txt"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\txmlhttp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("可以理解为一个可以发送"),s("code",[t._v("http")]),t._v("请求(就像是浏览器输入url地址那样)的API接口。")]),t._v(" "),s("h3",{attrs:{id:"ajax部分属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax部分属性"}},[t._v("#")]),t._v(" AJAX部分属性")]),t._v(" "),s("p",[t._v("具体可以参考"),s("code",[t._v("W3CSHCOOL-XMLHttpRequest")]),t._v("。")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("readyState")]),t._v("不等于"),s("code",[t._v("status")]),t._v("，后者是"),s("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/HTTP-%E7%8A%B6%E6%80%81%E7%A0%81.md",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("HTTP")]),t._v("状态码"),s("OutboundLink")],1),t._v("。前者只有4个状态，"),s("code",[t._v("=4")]),t._v("的时候代表成功。\n"),s("ul",[s("li",[s("code",[t._v("0")]),t._v(" - 创建"),s("code",[t._v("xhr")]),t._v("对象")]),t._v(" "),s("li",[s("code",[t._v("1")]),t._v(" - open")]),t._v(" "),s("li",[s("code",[t._v("2")]),t._v(" - send")]),t._v(" "),s("li",[s("code",[t._v("3")]),t._v(" - 部分数据")]),t._v(" "),s("li",[s("code",[t._v("4")]),t._v(" - 全部数据")])])]),t._v(" "),s("li",[s("code",[t._v("responseText")]),t._v("获取响应结果")]),t._v(" "),s("li",[t._v("流程基本为：\n"),s("ol",[s("li",[t._v("创建对象")]),t._v(" "),s("li",[s("code",[t._v("open")]),t._v("打开地址对象 - 需要两个参数分别是方式和地址\n* 可以"),s("a",{attrs:{href:"https://segmentfault.com/a/1190000004322487",target:"_blank",rel:"noopener noreferrer"}},[t._v("设置requestheader"),s("OutboundLink")],1),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[s("code",[t._v("send")]),t._v("发送请求")])])]),t._v(" "),s("li",[t._v("在得到响应之后"),s("code",[t._v("state")]),t._v("改变触发"),s("code",[t._v("onreadystatechange")]),t._v("，然后在函数内部判断是否成功。")])])]),t._v(" "),s("li",[t._v("可以在"),s("code",[t._v("send")]),t._v("中传递发送给后台的数据。")])]),t._v(" "),s("p",[t._v("更多设置见"),s("a",{attrs:{href:"https://segmentfault.com/a/1190000004322487",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考链接"),s("OutboundLink")],1),t._v(" / 包括告诉服务器接受数据类型等。")]),t._v(" "),s("h2",{attrs:{id:"ajax封装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax封装"}},[t._v("#")]),t._v(" AJAX封装")]),t._v(" "),s("p",[t._v("市面上有很多"),s("code",[t._v("AJAX")]),t._v("库，包括"),s("code",[t._v("JQuery.ajax")]),t._v("以及"),s("code",[t._v("vue")]),t._v("里面用到的"),s("code",[t._v("axios")]),t._v("。")]),t._v(" "),s("p",[t._v("本质上来说都是对"),s("code",[t._v("XMLHttpRequest")]),t._v("深层次的封装。可以让我们不考虑浏览器的环境，专注于真实的请求。")]),t._v(" "),s("p",[t._v("两者的区别在于：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("JQuery.ajax")]),t._v("成功失败都是回调函数，写在参数里面")]),t._v(" "),s("li",[s("code",[t._v("axios")]),t._v(" 则是"),s("code",[t._v("ES6")]),t._v("的写法。使用"),s("code",[t._v("Promise")])])]),t._v(" "),s("p",[t._v("如何单纯只是想要"),s("code",[t._v("ajax")]),t._v("显然"),s("code",[t._v("axios")]),t._v("更适合，体积更小。")]),t._v(" "),s("p",[s("strong",[t._v("注意，axios默认不带有cookie的")])]),t._v(" "),s("h2",{attrs:{id:"ajax预防csrfg"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax预防csrfg"}},[t._v("#")]),t._v(" AJAX预防CSRFG")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("axios")]),t._v("号称是预防"),s("code",[t._v("csrf")]),t._v("的。")])]),t._v(" "),s("p",[t._v("衍生开来，"),s("code",[t._v("AJAX")]),t._v("如何预防。在"),s("code",[t._v("aixos")]),t._v("可以设置一个参数"),s("code",[t._v("xsrfCookieName: 'XSRF-TOKEN'")]),t._v("来防止"),s("code",[t._v("CSRF")]),t._v("。")]),t._v(" "),s("p",[s("strong",[t._v("为什么？")])]),t._v(" "),s("p",[t._v("这就要涉及到"),s("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/xss%2Bcsrf.md",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("CSRF")]),t._v("攻击特点"),s("OutboundLink")],1),t._v("，就像是"),s("code",[t._v("JWT")]),t._v("可以防止"),s("code",[t._v("CSRF")]),t._v("一样。因为这种自发的（需要额外代码操作而不是浏览器的自发行为），给"),s("code",[t._v("cookie")]),t._v("上或者在向服务器发送的请求上加上额外的验证。都能够防止"),s("code",[t._v("CSRF")]),t._v("。")]),t._v(" "),s("h2",{attrs:{id:"ajax资源回收"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax资源回收"}},[t._v("#")]),t._v(" AJAX资源回收")]),t._v(" "),s("p",[t._v("如果不再需要"),s("code",[t._v("ajax")]),t._v("发送数据了。请将"),s("code",[t._v("xhr")]),t._v("对象为空，就像是"),s("a",{attrs:{href:"https://blog.csdn.net/sdfujichao/article/details/52119165",target:"_blank",rel:"noopener noreferrer"}},[t._v("jquery-ajax"),s("OutboundLink")],1),t._v("那样。")]),t._v(" "),s("h2",{attrs:{id:"ftech"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ftech"}},[t._v("#")]),t._v(" Ftech")]),t._v(" "),s("p",[s("a",{attrs:{href:""}},[t._v("@update 2018-05-29")])]),t._v(" "),s("p",[t._v("新时代新特性。")]),t._v(" "),s("p",[t._v("替换"),s("code",[t._v("XMLHttpRequest")]),t._v("的存在，不过暂时先不要用使用这个东西，不太稳定。")])])}),[],!1,null,null,null);a.default=n.exports}}]);