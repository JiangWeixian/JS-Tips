(window.webpackJsonp=window.webpackJsonp||[]).push([[143],{271:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"你不知道的js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#你不知道的js"}},[t._v("#")]),t._v(" 你不知道的JS")]),t._v(" "),a("blockquote",[a("p",[t._v("asyncandperformance")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84js"}},[t._v("你不知道的JS")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#1-ch1---async%E5%BC%82%E6%AD%A5"}},[t._v("1. CH1 - ASYNC(异步)")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#11-%E6%8E%A7%E5%88%B6%E5%8F%B0"}},[t._v("1.1 控制台")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#12-event-loop%E4%BA%8B%E4%BB%B6%E8%BD%AE%E8%AF%A2"}},[t._v("1.2 Event Loop(事件轮询)")])])])]),t._v(" "),a("li",[a("a",{attrs:{href:"#2-ch2---callback%E5%9B%9E%E8%B0%83"}},[t._v("2. CH2 - CallBack(回调)")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#21-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"}},[t._v("2.1 解决方案")])])])]),t._v(" "),a("li",[a("a",{attrs:{href:"#3-ch3---promise"}},[t._v("3. CH3 - Promise")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#31-promise%E8%A7%A3%E9%87%8A"}},[t._v("3.1 Promise解释")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#311-%E5%88%9B%E5%BB%BApromise"}},[t._v("3.1.1 创建Promise")])])])]),t._v(" "),a("li",[a("a",{attrs:{href:"#32-promise-tips"}},[t._v("3.2 Promise Tips")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#33-promise-warns"}},[t._v("3.3 Promise warns")])])])]),t._v(" "),a("li",[a("a",{attrs:{href:"#4-ch4---%E7%94%9F%E6%88%90%E5%99%A8%E8%BF%AD%E4%BB%A3%E5%99%A8"}},[t._v("4. CH4 - 生成器/迭代器")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#41-%E5%88%9D%E6%AD%A5%E4%BD%BF%E7%94%A8%E7%94%9F%E6%88%90%E5%99%A8"}},[t._v("4.1 初步使用生成器")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#411-sometips"}},[t._v("4.1.1 SomeTips")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#412-mutil-yeild"}},[t._v("4.1.2 Mutil yeild")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#413-%E5%BC%82%E6%AD%A5"}},[t._v("4.1.3 异步")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#414-%E7%94%9F%E6%88%90%E5%99%A8promise"}},[t._v("4.1.4 生成器+Promise")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#415-%E7%94%9F%E6%88%90%E5%99%A8%E5%A7%94%E6%89%98"}},[t._v("4.1.5 生成器委托")])])])]),t._v(" "),a("li",[a("a",{attrs:{href:"#42-%E8%BF%AD%E4%BB%A3%E5%99%A8iterator"}},[t._v("4.2 迭代器（iterator）")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#421-%E7%94%9F%E6%88%90%E5%99%A8%E8%BF%AD%E4%BB%A3%E5%99%A8"}},[t._v("4.2.1 生成器+迭代器")])])])])])]),t._v(" "),a("li",[a("a",{attrs:{href:"#6-ch6---%E7%A8%8B%E5%BA%8F%E6%80%A7%E8%83%BD"}},[t._v("6. CH6 - 程序性能")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#61-%E5%9F%BA%E7%A1%80%E5%88%86%E6%9E%90"}},[t._v("6.1 基础分析")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#62-%E4%B8%80%E4%BA%9B%E5%BF%A0%E5%91%8A"}},[t._v("6.2 一些忠告")])])])])])])])])]),t._v(" "),a("h2",{attrs:{id:"_1-ch1-async-异步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-ch1-async-异步"}},[t._v("#")]),t._v(" 1. CH1 - ASYNC(异步)")]),t._v(" "),a("p",[t._v("写"),a("code",[t._v("JavaScript")]),t._v("代码的时候会发现，其实有些代码是同步执行的。说法其实不太准确，因为这个"),a("code",[t._v("event loop")]),t._v("有关。先简单说明：")]),t._v(" "),a("ul",[a("li",[t._v("首先，"),a("code",[t._v("JS")]),t._v("代码执行顺序是和书写顺序无关的。")]),t._v(" "),a("li",[t._v("每一段执行的代码都会放到"),a("code",[t._v("event loop")]),t._v("里面，而书写顺序就可能代表了"),a("code",[t._v("loop")]),t._v("队列内顺序，这就是为什么看起来就是和书写顺序有关。"),a("strong",[t._v("这里暂时先讨论主线程内的代码")])])]),t._v(" "),a("h3",{attrs:{id:"_1-1-控制台"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-控制台"}},[t._v("#")]),t._v(" 1.1 控制台")]),t._v(" "),a("p",[t._v("还有一个问题是需要了解的是"),a("code",[t._v("console")]),t._v("其实并不是"),a("code",[t._v("JavaScript")]),t._v("官方内容，所以不同浏览器可能有不同标准。文中推荐使用"),a("strong",[t._v("断点调试")]),t._v("。")]),t._v(" "),a("p",[t._v("除了这个之外，"),a("code",[t._v("console.log")]),t._v("其实算是异步系统。个人认为算是级别最高的异步系统。")]),t._v(" "),a("h3",{attrs:{id:"_1-2-event-loop-事件轮询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-event-loop-事件轮询"}},[t._v("#")]),t._v(" 1.2 Event Loop(事件轮询)")]),t._v(" "),a("p",[t._v("和代码书写顺序什么关系？")]),t._v(" "),a("p",[t._v("首先代码书写顺序把事件压到了"),a("code",[t._v("event loop")]),t._v("中，如果在"),a("code",[t._v("event loop")]),t._v("中存在a事情没有干完。那么就会被挂起，执行下一件b事件。等待下一次轮询。")]),t._v(" "),a("p",[t._v("因此这就有点像是竞争关系，在主线程的两段代码同时运行。并不会等待其中一个完成然后再去完成下一次，这就是为什么看起来像是同时运行的代码。")]),t._v(" "),a("h2",{attrs:{id:"_2-ch2-callback-回调"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-ch2-callback-回调"}},[t._v("#")]),t._v(" 2. CH2 - CallBack(回调)")]),t._v(" "),a("ol",[a("li",[t._v("介绍了回调函数原理（看不太懂..）")]),t._v(" "),a("li",[t._v("回调函数的问题所在：\n"),a("ul",[a("li",[t._v("一但回调变多，简直就是地狱")]),t._v(" "),a("li",[t._v("回调函数要是第三方的，就会变得很麻烦。非常的掣肘。除非回调函数中有设置错误情况的处理，不然正确或者错误都交给一段代码，是非常不合理的。")])])])]),t._v(" "),a("p",[t._v("其中还举例，可以帮助第一章理解问题：")]),t._v(" "),a("div",{staticClass:"language-JavaScript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doA")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doB")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doC")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doD")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doF")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("执行循序为：")]),t._v(" "),a("ul",[a("li",[t._v("doA()")]),t._v(" "),a("li",[t._v("doF()")]),t._v(" "),a("li",[t._v("doB()")]),t._v(" "),a("li",[t._v("doC()")]),t._v(" "),a("li",[t._v("doE()")]),t._v(" "),a("li",[t._v("doD()")])]),t._v(" "),a("h3",{attrs:{id:"_2-1-解决方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-解决方案"}},[t._v("#")]),t._v(" 2.1 解决方案")]),t._v(" "),a("p",[a("code",[t._v("ES6")]),t._v("的"),a("code",[t._v("Promise")])]),t._v(" "),a("ul",[a("li",[t._v("解决第三方信任问题 - 自我设定了"),a("code",[t._v("fail")]),t._v("和"),a("code",[t._v("success")]),t._v("该怎么办。而不是让所有问题都在同一个回掉中处理。")]),t._v(" "),a("li",[t._v("以及更加简介，不容易后多个回调导致"),a("strong",[t._v("代码不易阅读")])])]),t._v(" "),a("h2",{attrs:{id:"_3-ch3-promise"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-ch3-promise"}},[t._v("#")]),t._v(" 3. CH3 - Promise")]),t._v(" "),a("p",[a("code",[t._v("Promise")]),t._v("是比回调函数更好用的设置。"),a("code",[t._v("Promise")]),t._v("的起因就是JavaScript并不能保证代码一条条的被执行，有的时候是同步执行。")]),t._v(" "),a("p",[t._v("博主"),a("a",{attrs:{href:"https://wohugb.gitbooks.io/ecmascript-6/content/docs/promise.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("解释地址"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"_3-1-promise解释"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-promise解释"}},[t._v("#")]),t._v(" 3.1 Promise解释")]),t._v(" "),a("p",[t._v("大致的使用就是：")]),t._v(" "),a("div",{staticClass:"language-JavaScript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("P")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("成功时候调用一个，不成功的时候调用一个。")]),t._v(" "),a("p",[t._v("具体使用还是看具体代码吧。书中讲的例子太抽象。")]),t._v(" "),a("p",[t._v("例子为：")]),t._v(" "),a("div",{staticClass:"language-JavaScript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("getJSON")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" promise "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" client "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onreadystatechange "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" handler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseType "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"json"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setRequestHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Accept"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"application/json"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n              "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n              "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("statusText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getJSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/posts.json"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("json")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Contents: '")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" json"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'出错了'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h4",{attrs:{id:"_3-1-1-创建promise"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-1-创建promise"}},[t._v("#")]),t._v(" 3.1.1 创建Promise")]),t._v(" "),a("ul",[a("li",[t._v("通过"),a("code",[t._v("new Promise")]),t._v("可以创建")]),t._v(" "),a("li",[a("code",[t._v("var a = Promise.resolve(参数)")])])]),t._v(" "),a("h3",{attrs:{id:"_3-2-promise-tips"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-promise-tips"}},[t._v("#")]),t._v(" 3.2 Promise Tips")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Promise.all")]),t._v(" - 传递的不仅仅只是"),a("code",[t._v("promise")]),t._v("的函数")]),t._v(" "),a("li",[t._v("链式使用"),a("code",[t._v("Promise")]),t._v("，方法就是"),a("code",[t._v("function")]),t._v("中返回一个"),a("code",[t._v("new Promise")]),t._v("或者"),a("code",[t._v("return Promise.solve")]),t._v("，然后就可以在外部"),a("code",[t._v(".then")]),t._v("链式调用了。"),a("strong",[t._v("通过new promise方法继续一个promise，resolve不传递参数也是可以使用的")])]),t._v(" "),a("li",[t._v("还有其他方法，例如"),a("code",[t._v(".then/.resolve/.reject/.finaly/.race")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("finaly")]),t._v("类似"),a("code",[t._v("try catch")]),t._v("无论如何都会被调用。但是同样也可以在其后使用"),a("code",[t._v("then")])]),t._v(" "),a("li",[a("code",[t._v("race")]),t._v("只要有其中一个完成了就接下去传递")])])]),t._v(" "),a("li",[t._v("还有一个"),a("code",[t._v(".async")]),t._v("值得看一看")])]),t._v(" "),a("h3",{attrs:{id:"_3-3-promise-warns"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-promise-warns"}},[t._v("#")]),t._v(" 3.3 Promise warns")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Promise")]),t._v("会吞掉所有的"),a("code",[t._v("error")]),t._v("，也就是说如果在"),a("code",[t._v("resolve")]),t._v("状态发生的"),a("code",[t._v("error")]),t._v("是不会被"),a("code",[t._v("reject")]),t._v("捕获的。\n"),a("ul",[a("li",[t._v("如果在"),a("code",[t._v("Promise")]),t._v("外面加上"),a("code",[t._v("try catch")]),t._v("是否可以捕获异常。应该是不可以的，因为一个是同步一个是异步。除非在"),a("code",[t._v("Promise")]),t._v("下使用。")])])]),t._v(" "),a("li",[a("code",[t._v("Promise")]),t._v("只能够被单次解析，一个"),a("code",[t._v("Promise")]),t._v("只能够被调用一次。除非创建函数"),a("code",[t._v("a")]),t._v("，函数作用就是在被调用的时候返回一个新的"),a("code",[t._v("promise")])]),t._v(" "),a("li",[t._v("目前还没有"),a("code",[t._v("map")]),t._v("方法 - 只能够自己实现"),a("div",{staticClass:"language-Javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("map")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("vals"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("cb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 一个等待所有被映射的promise的新promise")]),t._v("\n  \t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("all")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  \t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意：普通的数组`map(..)`，")]),t._v("\n  \t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将值的数组变为promise的数组")]),t._v("\n  \t\tvals"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("val")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  \t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将`val`替换为一个在`val`")]),t._v("\n  \t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 异步映射完成后才解析的新promise")]),t._v("\n  \t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  \t\t\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" resolve "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  \t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),t._v("这里有一个很关键的一点就是"),a("code",[t._v("cb")]),t._v("，这个决定了这是一个异步的方法。能够实现"),a("strong",[t._v("在迭代完成之前")]),t._v("每次迭代都调用，类似"),a("code",[t._v("gernerator")]),t._v("。\n能解决"),a("strong",[t._v("使用一个循环，每次循环进行一些操作(可能是promise)。在循环结束之后把值传递下去。")])]),t._v(" "),a("li",[a("code",[t._v("Promise")]),t._v("没办法被外部打断")])]),t._v(" "),a("h2",{attrs:{id:"_4-ch4-生成器-迭代器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-ch4-生成器-迭代器"}},[t._v("#")]),t._v(" 4. CH4 - 生成器/迭代器")]),t._v(" "),a("p",[t._v("生成器是"),a("code",[t._v("generator")]),t._v("，迭代器是"),a("code",[t._v("iterator")]),t._v("。")]),t._v(" "),a("p",[t._v("什么是生成器，对比"),a("code",[t._v("python")]),t._v("。简单来说，还有"),a("code",[t._v("yield")]),t._v("和"),a("code",[t._v("next")]),t._v("的是生成器。")]),t._v(" "),a("p",[t._v("说实话，这一章内容实在太难了。所以且看看，用到的时候，再说。所以，多试试"),a("code",[t._v("yield")]),t._v("？")]),t._v(" "),a("h3",{attrs:{id:"_4-1-初步使用生成器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-初步使用生成器"}},[t._v("#")]),t._v(" 4.1 初步使用生成器")]),t._v(" "),a("p",[t._v("定义迭代器函数方法为：")]),t._v(" "),a("div",{staticClass:"language-JavaScript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" x "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("foo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("yield")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 暂停！")]),t._v("\n\tconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"x:"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" x "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("其中"),a("code",[t._v("yield")]),t._v("相当于一个断点。")]),t._v(" "),a("h4",{attrs:{id:"_4-1-1-sometips"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-1-sometips"}},[t._v("#")]),t._v(" 4.1.1 SomeTips")]),t._v(" "),a("ul",[a("li",[t._v("运行生成器函数通过"),a("code",[t._v("var it = foo()")]),t._v("，"),a("code",[t._v("foo.next()")]),t._v("。执行"),a("code",[t._v("yield")]),t._v("之前代码，再一次"),a("code",[t._v(".next")]),t._v("执行后面的代码。\n"),a("ul",[a("li",[t._v("可以接受参数**但是仅仅局限在第二个next之后，第一个不需要输入参数。**总结来说，就是一次"),a("code",[t._v("next")]),t._v("执行一次"),a("code",[t._v("yeild")]),t._v("的代码。")])])]),t._v(" "),a("li",[t._v("生成器返回类型特别，是"),a("code",[t._v("object")]),t._v("。"),a("strong",[t._v("含有一个value以及状态")]),t._v("。而不是按照函数中返回数据。")]),t._v(" "),a("li",[t._v("迭代通信 - 非常棒的功能，前一次迭代和后一次迭代通信。通信含义是获取"),a("code",[t._v("next")]),t._v("输入的参数，中间的链接是通过"),a("code",[t._v("yeild")]),t._v("和"),a("code",[t._v("return")]),t._v("。\n"),a("ul",[a("li",[t._v("我们每次"),a("code",[t._v("next()")]),t._v("都会有一个返回状态，这个状态是谁给的？答案是"),a("code",[t._v("yeild")]),t._v("和"),a("code",[t._v("return")]),t._v("。进行一次"),a("code",[t._v("next")]),t._v("之后都会得到"),a("code",[t._v("yeild")]),t._v("返回的东西。")]),t._v(" "),a("li",[t._v("而最后一次"),a("code",[t._v("next")]),t._v("后面是不存在"),a("code",[t._v("yeild")]),t._v("。那么其状态就是通过"),a("code",[t._v("return")]),t._v("返回。")]),t._v(" "),a("li",[t._v("而在"),a("code",[t._v("next(a)")]),t._v("中传递的"),a("code",[t._v("a")]),t._v("参数会被插入到"),a("code",[t._v("yield")]),t._v("中。相当于"),a("code",[t._v("yield")]),t._v("变为了一个插槽。")]),t._v(" "),a("li",[t._v("假设没有"),a("code",[t._v("return")]),t._v("，那么我们可能只能通过传递上一次得到的结果。作为这一次迭代器的输入，才能达到通信的目的了。")])])]),t._v(" "),a("li",[t._v("迭代器并不是只有"),a("code",[t._v("next")]),t._v("一个关键函数，还有"),a("code",[t._v("throw")]),t._v("抛出异常的函数。")]),t._v(" "),a("li",[t._v("如果记得没错，迭代器和生成器都有一个状态**表明是否"),a("code",[t._v("next")]),t._v("运行到最后。**具体查看文档。")])]),t._v(" "),a("h4",{attrs:{id:"_4-1-2-mutil-yeild"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-2-mutil-yeild"}},[t._v("#")]),t._v(" 4.1.2 Mutil yeild")]),t._v(" "),a("p",[t._v("指的是一个迭代器函数内部具有多个"),a("code",[t._v("yeild")]),t._v("。")]),t._v(" "),a("h4",{attrs:{id:"_4-1-3-异步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-3-异步"}},[t._v("#")]),t._v(" 4.1.3 异步")]),t._v(" "),a("p",[t._v("以前，使用"),a("code",[t._v("nodejs")]),t._v("写微信公众号后台时候。记得用到了"),a("code",[t._v("yield foo()")]),t._v("此类类似的代码。相当于执行到第一个"),a("code",[t._v("yield")]),t._v("，并获取返回数值。")]),t._v(" "),a("p",[t._v("异步，也就是利用"),a("code",[t._v("yield")]),t._v("此种具有中断性质的实现的。")]),t._v(" "),a("h4",{attrs:{id:"_4-1-4-生成器-promise"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-4-生成器-promise"}},[t._v("#")]),t._v(" 4.1.4 生成器+Promise")]),t._v(" "),a("p",[t._v("文中认为这是最棒的东西。")]),t._v(" "),a("p",[t._v("要"),a("code",[t._v("yield")]),t._v("和"),a("code",[t._v("return")]),t._v("共同使用，关键在意"),a("code",[t._v("yeild Promise")]),t._v("。")]),t._v(" "),a("h4",{attrs:{id:"_4-1-5-生成器委托"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-5-生成器委托"}},[t._v("#")]),t._v(" 4.1.5 生成器委托")]),t._v(" "),a("p",[t._v("看不懂")]),t._v(" "),a("h3",{attrs:{id:"_4-2-迭代器（iterator）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-迭代器（iterator）"}},[t._v("#")]),t._v(" 4.2 迭代器（iterator）")]),t._v(" "),a("p",[t._v("迭代器更加复杂，相较于生成器。感觉是进阶版本，普通的"),a("code",[t._v("yeild")]),t._v("和"),a("code",[t._v("next")]),t._v("的特征无法判断是否是迭代器。")]),t._v(" "),a("p",[t._v("那么如何判断一个变量是否是迭代器（因为迭代器有自身的函数属性，可以调用），迭代器的特征是"),a("code",[t._v("Symbol.iterator")]),t._v("。可见它是属于"),a("code",[t._v("symbol")]),t._v("的。一般也会在变量的"),a("code",[t._v("__proto__")]),t._v("中。")]),t._v(" "),a("h4",{attrs:{id:"_4-2-1-生成器-迭代器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-生成器-迭代器"}},[t._v("#")]),t._v(" 4.2.1 生成器+迭代器")]),t._v(" "),a("p",[t._v("如果我们自定义迭代器，往往代码结果比较复杂。")]),t._v(" "),a("p",[t._v("我们可以使用"),a("code",[t._v("yeild")]),t._v("来简单利用生成器的只是，构造我们的迭代器。代码如下：")]),t._v(" "),a("div",{staticClass:"language-JavaScript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("something")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" nextVal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nextVal "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tnextVal "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tnextVal "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" nextVal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("yield")]),t._v(" nextVal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("如果让上述函数使用迭代器的特有函数，文中举例如下：")]),t._v(" "),a("div",{staticClass:"language-JavaScript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" v "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("something")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" v "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不要让循环永无休止！")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1 9 33 105 321 969")]),t._v("\n")])])]),a("ul",[a("li",[t._v("由于函数内部有"),a("code",[t._v("while(true)")]),t._v("，所以外部需要加一个终止条件。也可以使用"),a("code",[t._v("try...finally")]),t._v("在函数内部加上终止条件。")]),t._v(" "),a("li",[t._v("和"),a("code",[t._v("iteration")]),t._v("不同的地方在于，生成器必须是有"),a("code",[t._v("xx()")]),t._v("的执行过程。")])]),t._v(" "),a("h2",{attrs:{id:"_6-ch6-程序性能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-ch6-程序性能"}},[t._v("#")]),t._v(" 6. CH6 - 程序性能")]),t._v(" "),a("h3",{attrs:{id:"_6-1-基础分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-基础分析"}},[t._v("#")]),t._v(" 6.1 基础分析")]),t._v(" "),a("p",[t._v("一般我们都会想知道一个程序运行时间。直观的想法是：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("var start = (new Date()).getTime()")])]),t._v(" "),a("li",[a("code",[t._v("var end = (new Date()).getTime()")])])]),t._v(" "),a("p",[t._v("然后两者一减，得到我们最终想要运行时间。")]),t._v(" "),a("p",[a("strong",[t._v("但这个并不严谨，因为可能中间发生一些意外导致时间不准确。")])]),t._v(" "),a("p",[t._v("文中提到了几个测试工具：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("benchmark.js")]),t._v("进行代码的性能测试。")]),t._v(" "),a("li",[a("code",[t._v("jsPerf.com")]),t._v("效果更好")])]),t._v(" "),a("h4",{attrs:{id:"_6-2-一些忠告"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-一些忠告"}},[t._v("#")]),t._v(" 6.2 一些忠告")]),t._v(" "),a("p",[t._v("不要纠结一些细小的差别，比如"),a("code",[t._v("--n")]),t._v("或者"),a("code",[t._v("n--")]),t._v("对性能的影响。性能好坏很大成都上取决于引擎如何解释这一段代码。而且不同浏览器代码还不一样。")])])}),[],!1,null,null,null);s.default=e.exports}}]);