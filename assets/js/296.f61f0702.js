(window.webpackJsonp=window.webpackJsonp||[]).push([[296],{477:function(v,_,e){"use strict";e.r(_);var t=e(0),r=Object(t.a)({},(function(){var v=this,_=v.$createElement,e=v._self._c||_;return e("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[e("h1",{attrs:{id:"http-图片性能优化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http-图片性能优化"}},[v._v("#")]),v._v(" HTTP - 图片性能优化")]),v._v(" "),e("blockquote",[e("p",[v._v("和HTTP有关，不止是HTTP优化")])]),v._v(" "),e("h2",{attrs:{id:"图片下载阶段"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#图片下载阶段"}},[v._v("#")]),v._v(" 图片下载阶段")]),v._v(" "),e("ol",[e("li",[v._v("如果是"),e("code",[v._v("image")]),v._v("标签，处于"),e("code",[v._v("domcontentload")]),v._v("和"),e("code",[v._v("load")]),v._v("之间，并不会干扰页面渲染出现")]),v._v(" "),e("li",[v._v("如果是来自"),e("code",[v._v("css")]),v._v("文件，处于"),e("code",[v._v("domcontentload")]),v._v("和"),e("code",[v._v("load")]),v._v("之间，并不会干扰页面渲染出现。")])]),v._v(" "),e("p",[v._v("以上两点见"),e("a",{attrs:{href:""}},[v._v("Browser-页面渲染原理")])]),v._v(" "),e("p",[v._v("如果"),e("code",[v._v("image")]),v._v("标签"),e("code",[v._v("src")]),v._v("是"),e("code",[v._v("datauri")]),v._v("（指的是那些 "),e("strong",[v._v("经过编码")]),v._v(" 的图像），就要跟随"),e("code",[v._v("html")]),v._v("共同下载，同样如果来自"),e("code",[v._v("css")]),v._v("文件的"),e("code",[v._v("image")]),v._v("是"),e("code",[v._v("datauri")]),v._v("的话，跟随"),e("code",[v._v("css")]),v._v("共同下载，延长了两个下载时间，导致渲染变慢。见"),e("a",{attrs:{href:""}},[v._v("HTML-datauri")])]),v._v(" "),e("h2",{attrs:{id:"性能优化思路"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#性能优化思路"}},[v._v("#")]),v._v(" 性能优化思路")]),v._v(" "),e("ol",[e("li",[v._v("合并HTTP请求")])]),v._v(" "),e("ul",[e("li",[v._v("图片和"),e("code",[v._v("HTML OR CSS")]),v._v("一起下载 - 将"),e("code",[v._v("image-src")]),v._v("变为"),e("code",[v._v("datauri")]),v._v("作为"),e("code",[v._v("image-src")]),v._v("或者"),e("code",[v._v("background-url")]),v._v("。关于这一点的优势和危害见"),e("a",{attrs:{href:""}},[v._v("HTML-datauri")])]),v._v(" "),e("li",[v._v("雪碧图/精灵图(其实是一个东西) - "),e("code",[v._v("CSS")]),v._v("中使用，可能内含有很多图片地址(都是需要使用的)，如果将这些图片地址合并为同一个地址，就可以减少"),e("code",[v._v("HTTP")]),v._v("请求。")])]),v._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[v._v("压缩 - 图片压缩("),e("a",{attrs:{href:"https://zh.wikipedia.org/wiki/%E4%BF%A1%E6%BA%90%E7%BC%96%E7%A0%81%E5%AE%9A%E7%90%86",target:"_blank",rel:"noopener noreferrer"}},[v._v("信源编码"),e("OutboundLink")],1),v._v("的知识，所以可以无损或者有损)，使用新的图片格式也是属于压缩一部分")])]),v._v(" "),e("p",[v._v("(第三点是响应话的做法，与"),e("code",[v._v("HTTP")]),v._v("之类的优化无关)\n3. 合理利用 - 指的是移动端适配。差一点的屏幕不需要那么好的分辨率图片。")]),v._v(" "),e("ul",[e("li",[v._v("img - "),e("code",[v._v("srcsets or sizes")])]),v._v(" "),e("li",[e("code",[v._v("picture with source")]),v._v(" - 比上面那个更好理解")])]),v._v(" "),e("p",[v._v("(优化体验的)\n4. 懒加载/预加载")]),v._v(" "),e("p",[e("strong",[v._v("一些比较少见的")])]),v._v(" "),e("ol",[e("li",[v._v("图片地址预解析。")]),v._v(" "),e("li",[v._v("使用"),e("code",[v._v("svg")]),v._v("或者字体来替换部分图片")]),v._v(" "),e("li",[e("strong",[e("code",[v._v("img src")]),v._v("不要设置为空，因为这样会导致额外的http请求(经过某些算法转换为相对路径什么的，这样的做法是标准之一)")])])]),v._v(" "),e("h2",{attrs:{id:"img-srcset-size"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#img-srcset-size"}},[v._v("#")]),v._v(" img - srcset&size")]),v._v(" "),e("blockquote",[e("p",[v._v("来自"),e("a",{attrs:{href:"https://www.zhangxinxu.com/wordpress/2014/10/responsive-images-srcset-size-w-descriptor/",target:"_blank",rel:"noopener noreferrer"}},[v._v("@张鑫旭"),e("OutboundLink")],1),v._v(" / 做做笔记免得忘记了")])]),v._v(" "),e("p",[e("strong",[e("code",[v._v("srcset")]),v._v("单独使用时...")])]),v._v(" "),e("p",[e("code",[v._v("srcset")]),v._v("以"),e("code",[v._v("1x or 2x or 3x")]),v._v("的时候，只根据"),e("code",[v._v("deviceradio")]),v._v("选择。")]),v._v(" "),e("p",[e("strong",[v._v("主要是sizes&srcset组合使用的时候比较令我疑惑...")])]),v._v(" "),e("p",[e("code",[v._v("sizes")]),v._v("定义的是"),e("code",[v._v("img")]),v._v("这个标签大小，例如文中"),e("code",[v._v("(max-width: 360px) 340px, 128px")]),v._v("为屏幕宽度大于"),e("code",[v._v("360px")]),v._v("时候，"),e("code",[v._v("img")]),v._v("标签宽度为"),e("code",[v._v("128px")]),v._v("，小于就为"),e("code",[v._v("340px")])]),v._v(" "),e("p",[v._v("(主要是要理解这个"),e("code",[v._v("w")]),v._v(")\n"),e("code",[v._v("srcset")]),v._v("此时无法独立使用，"),e("strong",[v._v("要结合deviceradio来看")]),v._v("，即当"),e("code",[v._v("size")]),v._v("选择之后，"),e("code",[v._v("img")]),v._v("标签为"),e("code",[v._v("128px")]),v._v("的时候，此时假设"),e("code",[v._v("deviceradio=2")]),v._v("。那么就选择"),e("code",[v._v("256w")]),v._v("，等于1就是"),e("code",[v._v("128w")]),v._v("。")]),v._v(" "),e("blockquote",[e("p",[v._v("若256w就在加载"),e("code",[v._v("srcset: a.jpg 256w;")]),v._v("中此时"),e("code",[v._v("a.jpg")]),v._v("图片。")])]),v._v(" "),e("h2",{attrs:{id:"q-a"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#q-a"}},[v._v("#")]),v._v(" Q&A")]),v._v(" "),e("ul",[e("li",[e("strong",[v._v("Q&A1 -")]),v._v(" 如果"),e("code",[v._v("css")]),v._v("文件含有多个"),e("code",[v._v("url")]),v._v("下载，在"),e("code",[v._v("domcontentload")]),v._v("和"),e("code",[v._v("load")]),v._v("之间是全部下载。"),e("strong",[v._v("还是用到那些选择器中的"),e("code",[v._v("url")]),v._v("才会继续下载？")])])]),v._v(" "),e("p",[v._v("在"),e("a",{attrs:{href:""}},[v._v("图片加载测试.html")]),v._v("中发现，如果没有使用"),e("code",[v._v("bg")]),v._v("这个选择器，是不会下载该图片的。")]),v._v(" "),e("p",[v._v("这一点对于"),e("a",{attrs:{href:""}},[v._v("性能优化思路")]),v._v("性能优化思路第三点也是成立的，并不会下载不满足条件的图片。")]),v._v(" "),e("h2",{attrs:{id:"链接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#链接"}},[v._v("#")]),v._v(" 链接")]),v._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://juejin.im/post/59a7725b6fb9a02497170459",target:"_blank",rel:"noopener noreferrer"}},[v._v("图片性能优化"),e("OutboundLink")],1)]),v._v(" "),e("li",[e("a",{attrs:{href:"https://www.jianshu.com/p/55e48032b30e",target:"_blank",rel:"noopener noreferrer"}},[v._v("例子补充"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);_.default=r.exports}}]);