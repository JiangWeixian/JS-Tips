(window.webpackJsonp=window.webpackJsonp||[]).push([[169],{269:function(_,v,e){"use strict";e.r(v);var o=e(0),r=Object(o.a)({},(function(){var _=this,v=_.$createElement,e=_._self._c||v;return e("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[e("h1",{attrs:{id:"浏览器渲染原理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#浏览器渲染原理"}},[_._v("#")]),_._v(" 浏览器渲染原理")]),_._v(" "),e("blockquote",[e("p",[_._v("调整为slow-3g；每次刷新记得clear-cache")])]),_._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93%E5%8E%9F%E7%90%86"}},[_._v("浏览器渲染原理")]),_._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#11-%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86---%E6%9E%84%E5%BB%BA%E6%B8%B2%E6%9F%93"}},[_._v("1.1. 前置知识 - 构建&渲染")])]),_._v(" "),e("li",[e("a",{attrs:{href:"#12-%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86---domcontentloadload"}},[_._v("1.2. 前置知识 - DOMContentload&load")])]),_._v(" "),e("li",[e("a",{attrs:{href:"#13-%E5%88%9D%E6%8E%A2---%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93%E6%B5%81%E7%A8%8B"}},[_._v("1.3. 初探 - 浏览器渲染流程")]),_._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#131-%E5%81%87%E8%AE%BE%E6%B2%A1%E6%9C%89script"}},[_._v("1.3.1. 假设没有SCRIPT")])]),_._v(" "),e("li",[e("a",{attrs:{href:"#132-%E5%8A%A0%E5%85%A5script%E4%B8%8D%E5%90%AB%E6%9C%89defer-or-async"}},[_._v("1.3.2. 加入SCRIPT(不含有"),e("code",[_._v("defer or async")]),_._v(")")])]),_._v(" "),e("li",[e("a",{attrs:{href:"#133-%E5%8A%A0%E5%85%A5script%E5%90%AB%E6%9C%89defer-or-async"}},[_._v("1.3.3. 加入SCRIPT(含有"),e("code",[_._v("defer or async")]),_._v(")")])]),_._v(" "),e("li",[e("a",{attrs:{href:"#134-%E9%A2%98%E5%A4%96%E8%AF%9D"}},[_._v("1.3.4. 题外话")])])])]),_._v(" "),e("li",[e("a",{attrs:{href:"#14-%E6%B8%B2%E6%9F%93%E5%86%8D%E6%AC%A1---%E9%87%8D%E6%96%B0%E5%BC%80%E5%A7%8B"}},[_._v("1.4. 渲染再次 - 重新开始")])]),_._v(" "),e("li",[e("a",{attrs:{href:"#15-%E6%80%BB%E7%BB%93"}},[_._v("1.5. 总结")])]),_._v(" "),e("li",[e("a",{attrs:{href:"#16-%E9%93%BE%E6%8E%A5"}},[_._v("1.6. 链接")])])])])]),_._v(" "),e("h2",{attrs:{id:"_1-1-前置知识-构建-渲染"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-前置知识-构建-渲染"}},[_._v("#")]),_._v(" 1.1. 前置知识 - 构建&渲染")]),_._v(" "),e("ul",[e("li",[e("p",[_._v("构建 - 由文件得到数据结构")])]),_._v(" "),e("li",[e("p",[_._v("渲染 - 就是可以看到呈现的画面 - 是"),e("code",[_._v("cssdom and htmldom")]),_._v("组合构成的行为")]),_._v(" "),e("p",[_._v("如果是"),e("code",[_._v("link html script")]),_._v("这样的顺序。")]),_._v(" "),e("blockquote",[e("p",[_._v("如果页面中为"),e("code",[_._v("link html (no defer async)script")]),_._v("的构成。只会等待前面两个完成就会出现页面。见"),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/docs/Broswer/HTML/script.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("(no defer async)script.html"),e("OutboundLink")],1),_._v("测试，但是如果"),e("code",[_._v("script")]),_._v("中存在修改样式代码，可能会出现页面重新绘制。"),e("strong",[_._v("这里需要注意的是，如果script足够小，且运行速度够快，这个过程可以忽略不计。如果需要一定时间下载运行，可能会出现闪烁")])])]),_._v(" "),e("blockquote",[e("p",[_._v("如果"),e("code",[_._v("link html (async defer)script")]),_._v("只会等待前面两个完成就会出现页面，"),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/defer-script.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("(调整网络为slow-3g)defer-script.html"),e("OutboundLink")],1),_._v("和"),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/async-script.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("(调整网络为slow-3g)async-script.html"),e("OutboundLink")],1),_._v("都是一样的情况。")])]),_._v(" "),e("p",[_._v("说明了如果是"),e("code",[_._v("link html script")]),_._v("这样的顺序。"),e("code",[_._v("defer async")]),_._v("对 "),e("strong",[_._v("初始化")]),_._v("渲染结果的影响不大。")]),_._v(" "),e("p",[_._v("如果是"),e("code",[_._v("link script html")]),_._v("这样的顺序。")]),_._v(" "),e("blockquote",[e("p",[_._v("如果页面中为"),e("code",[_._v("link html (no defer async)script")]),_._v("的构成。那么页面渲染需要等待这三个全部完成。见"),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/normal-script%E9%A1%B5%E9%9D%A2%E4%BD%8D%E7%BD%AE%E6%B5%8B%E8%AF%95.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("(no defer async)normal-script位置测试.html"),e("OutboundLink")],1)])]),_._v(" "),e("blockquote",[e("p",[_._v("如果"),e("code",[_._v("link html (defer)script")]),_._v("只会等待前面两个完成就会出现页面("),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/defer-script%E9%A1%B5%E9%9D%A2%E4%BD%8D%E7%BD%AE%E6%B5%8B%E8%AF%95.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("(调整网络为slow-3g)defer-script位置测试.html"),e("OutboundLink")],1),_._v(")。如果是"),e("code",[_._v("async")]),_._v("由于加载完成时间不一致，可能还是会出现阻塞的情况("),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/async-script%E9%A1%B5%E9%9D%A2%E4%BD%8D%E7%BD%AE%E6%B5%8B%E8%AF%95.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("(调整网络为slow-3g)async-script位置测试.html"),e("OutboundLink")],1),_._v("都是比较大的文件，所以并没有出现阻塞情况)")])]),_._v(" "),e("p",[_._v("说明如果"),e("code",[_._v("script")]),_._v("位置提前，就会体现出"),e("code",[_._v("defer and script")]),_._v("特性。")])])]),_._v(" "),e("h2",{attrs:{id:"_1-2-前置知识-domcontentload-load"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-前置知识-domcontentload-load"}},[_._v("#")]),_._v(" 1.2. 前置知识 - DOMContentload&load")]),_._v(" "),e("p",[e("a",{attrs:{href:"http://www.alloyteam.com/2014/03/effect-js-css-and-img-event-of-domcontentloaded/",target:"_blank",rel:"noopener noreferrer"}},[_._v("alloyteam参考链接"),e("OutboundLink")],1)]),_._v(" "),e("p",[_._v("顺序为"),e("code",[_._v("DOMContentload->图片->load")])]),_._v(" "),e("ul",[e("li",[_._v("DOMContentload - "),e("code",[_._v("HTMLDOM")]),_._v("解析完毕就会触发(不需要等待样式表图片，样式表下载和解析属于同步过程，"),e("strong",[_._v("但是需要等待所有的JS文件执行完成，见注意1")]),_._v(")")]),_._v(" "),e("li",[_._v("load - 在DOMContentload触发之后，加载完成所有资源(包括样式表图片，脚本文件)之后触发")])]),_._v(" "),e("p",[e("strong",[_._v("注意1：需要等待所有的(normal defer not async)JS文件执行完成")])]),_._v(" "),e("p",[_._v("在"),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/script.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("(no defer async)script.html"),e("OutboundLink")],1),_._v("中 - 将"),e("code",[_._v("script")]),_._v("放在结尾测试，此时脚本下载不干扰"),e("code",[_._v("dom")]),_._v("解析。将"),e("code",[_._v("script")]),_._v("放在头部"),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/normal-script%E9%A1%B5%E9%9D%A2%E4%BD%8D%E7%BD%AE%E6%B5%8B%E8%AF%95.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("(no defer async)normal-script位置测试.html"),e("OutboundLink")],1),_._v("，会干扰dom解析。虽然两个都是在JS脚本完成之后再触发"),e("code",[_._v("DOMContentload")]),_._v("("),e("code",[_._v("DOMContentload")]),_._v("触发时可以打印出"),e("code",[_._v("windows.$")]),_._v(")。但是实际情况有所不同，前者白屏时间比较短。")]),_._v(" "),e("p",[_._v("由于"),e("code",[_._v("defer")]),_._v("的特性在于且 "),e("strong",[_._v("在"),e("code",[_._v("DOMCONTENTLOAD")]),_._v("之前执行，且下载的时候不干扰dom解析，因此放在那里位置都是可以的。")]),_._v(" 见"),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/defer-script%E9%A1%B5%E9%9D%A2%E4%BD%8D%E7%BD%AE%E6%B5%8B%E8%AF%95.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("(调整网络为slow-3g)defer-script位置测试.html"),e("OutboundLink")],1),_._v("和"),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/async-script%E9%A1%B5%E9%9D%A2%E4%BD%8D%E7%BD%AE%E6%B5%8B%E8%AF%95.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("(调整网络为slow-3g)async-script位置测试.html"),e("OutboundLink")],1),_._v("测试，无论"),e("code",[_._v("defer")]),_._v("在开头还是结尾("),e("code",[_._v("DOMContentload")]),_._v("触发时可以打印出"),e("code",[_._v("windows.$")]),_._v(")")]),_._v(" "),e("p",[_._v("综合"),e("code",[_._v("normal and defer")]),_._v("测试可以得到结论：")]),_._v(" "),e("blockquote",[e("p",[_._v("可以发现"),e("code",[_._v("DOMCONTENTLOAD")]),_._v("等待"),e("code",[_._v("normal script")]),_._v("是因为渲染特性，等待"),e("code",[_._v("defer")]),_._v("是因为其规定在"),e("code",[_._v("DOMCONTENTLOAD")]),_._v("之前执行。")])]),_._v(" "),e("blockquote",[e("p",[_._v("可以发现写在最后可以发现有无"),e("code",[_._v("defer")]),_._v("结果表现一致，这和现代浏览器并行下载"),e("code",[_._v("script")]),_._v("有关。")])]),_._v(" "),e("p",[_._v("对于"),e("code",[_._v("async")]),_._v("，在"),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/defer-script%E9%A1%B5%E9%9D%A2%E4%BD%8D%E7%BD%AE%E6%B5%8B%E8%AF%95.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("(调整网络为slow-3g)defer-script位置测试.html"),e("OutboundLink")],1),_._v("和"),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/async-script%E9%A1%B5%E9%9D%A2%E4%BD%8D%E7%BD%AE%E6%B5%8B%E8%AF%95.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("(调整网络为slow-3g)async-script位置测试.html"),e("OutboundLink")],1),_._v("测试发现有所 "),e("strong",[_._v("不同")]),_._v("("),e("code",[_._v("DOMContentload")]),_._v("触发时无法打印出"),e("code",[_._v("windows.$")]),_._v(")。说明:")]),_._v(" "),e("blockquote",[e("p",[e("code",[_._v("async")]),_._v("不会严格等待"),e("code",[_._v("DOMCONTENTLOAD")]),_._v("之前执行，"),e("code",[_._v("DOMCONTENTLOAD")]),_._v("也不会因为"),e("code",[_._v("async JS")]),_._v("文件没有下载完就不触发。"),e("strong",[_._v("取决于async 是否能够"),e("code",[_._v("DOMCONTENTLOAD")]),_._v("触发时候下载完成")]),_._v(" 在上面两个例子由于"),e("code",[_._v("JS")]),_._v("文件比较大，所以在"),e("code",[_._v("DOMCONTENTLOAD")]),_._v("之前并没有下载完全。")])]),_._v(" "),e("blockquote",[e("p",[_._v("如果比较小的文件，可能会在"),e("code",[_._v("DOMCONTENTLOAD")]),_._v("之前完成")])]),_._v(" "),e("p",[e("strong",[_._v("注意2：DOMContentload被css干扰了解释")])]),_._v(" "),e("p",[_._v("虽然"),e("code",[_._v("DOMContentload")]),_._v("不需要等待样式文件，"),e("a",{attrs:{href:""}},[_._v("Q&A3")]),_._v(" - 但是由于"),e("code",[_._v("css")]),_._v("文件会干扰后面的"),e("code",[_._v("js")]),_._v("文件，所以还是看起来会"),e("code",[_._v("domcontentload")]),_._v("被"),e("code",[_._v("css")]),_._v("干扰了。")]),_._v(" "),e("p",[_._v("按照"),e("a",{attrs:{href:""}},[_._v("Q&A2")]),_._v("的理论，如果我们把"),e("code",[_._v("JS")]),_._v("文件放在"),e("code",[_._v("CSS")]),_._v("文件之前，就会出现"),e("code",[_._v("CSS")]),_._v("文件阻塞后面的"),e("code",[_._v("JS")]),_._v("文件，结合"),e("a",{attrs:{href:""}},[_._v("注意1")]),_._v("总结，看起来像是"),e("code",[_._v("DOMContentload")]),_._v("被"),e("code",[_._v("CSS")]),_._v("阻塞。就像是"),e("a",{attrs:{href:""}},[_._v("domcontentload.html")]),_._v("测试那样，按照以下步骤：")]),_._v(" "),e("ol",[e("li",[_._v("将网络调整为offline")]),_._v(" "),e("li",[_._v("然后将网络调整为slow 3g")]),_._v(" "),e("li",[_._v("刷新页面，就会在"),e("code",[_._v("console.log")]),_._v("上看到先是"),e("code",[_._v("domcontentload")]),_._v("然后慢慢的才是页面出现样式。证明了"),e("a",{attrs:{href:""}},[_._v("Q&A2")]),_._v("以及"),e("code",[_._v("domcontentload")]),_._v("的确和"),e("code",[_._v("CSS")]),_._v("无关。")])]),_._v(" "),e("p",[e("strong",[_._v("注意3：由于DOMContentload与CSS无关，所以此时"),e("code",[_._v("DOMContentload")]),_._v("触发的时候并不一定会出现页面")])]),_._v(" "),e("h2",{attrs:{id:"_1-3-初探-浏览器渲染流程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-初探-浏览器渲染流程"}},[_._v("#")]),_._v(" 1.3. 初探 - 浏览器渲染流程")]),_._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/JiangWeixian/JS-Tips/master/Broswer/img/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93%E5%8E%9F%E7%90%86.png",alt:"渲染流程图"}})]),_._v(" "),e("p",[_._v("上图表明了"),e("code",[_._v("html&css&js")]),_._v("都会改变"),e("code",[_._v("dom")]),_._v("。由以上可以得到结论")]),_._v(" "),e("ol",[e("li",[e("code",[_._v("CSS - CSSDOM")]),_._v("下载构建不会影响"),e("code",[_._v("HTMLDOM")]),_._v("构建，但是只有"),e("code",[_._v("CSSDOM and HTMLDOM")]),_._v("全部完成之后才会呈现页面(这部分叫渲染)。同时如果"),e("code",[_._v("CSS")]),_._v("文件后面如果有"),e("code",[_._v("JS")]),_._v("脚本，"),e("code",[_._v("JS")]),_._v("脚本需要等待"),e("code",[_._v("CSSDOM")]),_._v("下载或者解析。")]),_._v(" "),e("li",[e("code",[_._v("HTML - HTMLDOM")])]),_._v(" "),e("li",[e("code",[_._v("JS - DOMAPI")]),_._v("会影响到"),e("code",[_._v("CSSDOM")]),_._v("以及"),e("code",[_._v("HTMLDOM")]),_._v("。所以如果"),e("code",[_._v("JS")]),_._v("写在"),e("code",[_._v("CSS or HTML")]),_._v("之前，就会干扰"),e("code",[_._v("CSS or HTML")]),_._v("任何一个过程"),e("a",{attrs:{href:""}},[_._v("Q&A2")]),_._v("，所以一般将文件放在页面最下方。")])]),_._v(" "),e("p",[e("strong",[_._v("题外话")])]),_._v(" "),e("p",[_._v("如果将"),e("code",[_._v("JS")]),_._v("代码写在"),e("code",[_._v("HTML")]),_._v("结构中。"),e("code",[_._v("HTML")]),_._v("解析中遇到了"),e("code",[_._v("script")]),_._v("标签，浏览器会 "),e("strong",[_._v("下载以及执行")]),_._v(" 执行"),e("code",[_._v("script")]),_._v("标签中的"),e("code",[_._v("JS")]),_._v("代码。")]),_._v(" "),e("p",[e("strong",[_._v("所以并不是同步进行，书写顺序十分重要")])]),_._v(" "),e("p",[_._v("其中前两个会构造"),e("code",[_._v("DOM TREE")]),_._v("，其中"),e("code",[_._v("CSS")]),_._v("是"),e("code",[_._v("CSS DOM TREE")]),_._v("，"),e("code",[_._v("HTML")]),_._v("是"),e("code",[_._v("HTML DOM TREE")]),_._v("。"),e("strong",[_._v("这三个都会作用页面样式布局")]),_._v("，其顺序如何？有以下几个规则：")]),_._v(" "),e("h3",{attrs:{id:"_1-3-1-假设没有script"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-假设没有script"}},[_._v("#")]),_._v(" 1.3.1. 假设没有SCRIPT")]),_._v(" "),e("ul",[e("li",[e("code",[_._v("CSS")]),_._v("构建"),e("code",[_._v("CSSDOM")]),_._v(" - 对于"),e("code",[_._v("link")]),_._v("标签来说，其下载过程不会干扰"),e("code",[_._v("DOM")]),_._v("解析(因为"),e("code",[_._v("CSS")]),_._v("文件没有修改添加或删除页面标签的能力，所以构建"),e("code",[_._v("HTMLDOM")]),_._v("的时候也不会)，同理自然构建"),e("code",[_._v("CSSDOM")]),_._v("的过程也是不会。")]),_._v(" "),e("li",[_._v("由于"),e("code",[_._v("CSS")]),_._v("文件下载(or 构建)不干扰解析"),e("code",[_._v("HTML")]),_._v("结构，"),e("code",[_._v("HTML")]),_._v("结构同步在构建的过程中。")])]),_._v(" "),e("p",[e("strong",[_._v("注意：虽然不阻塞构建，但是会影响渲染")])]),_._v(" "),e("p",[e("code",[_._v("HTML DOM")]),_._v("构建完成之后，页面并不会呈现。因为此时"),e("code",[_._v("CSS")]),_._v("文件可能还处于下载以及构建过程中。当"),e("code",[_._v("CSS and HTML")]),_._v("都完成了，页面就会呈现。")]),_._v(" "),e("h3",{attrs:{id:"_1-3-2-加入script-不含有defer-or-async"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-加入script-不含有defer-or-async"}},[_._v("#")]),_._v(" 1.3.2. 加入SCRIPT(不含有"),e("code",[_._v("defer or async")]),_._v(")")]),_._v(" "),e("p",[e("code",[_._v("script")]),_._v("文件中可能含有对"),e("code",[_._v("DOM")]),_._v("结构操作(可能是通过标签或许是通过class，以及可能要获取样式)")]),_._v(" "),e("p",[e("strong",[_._v("同步&异步")])]),_._v(" "),e("blockquote",[e("p",[_._v("对于"),e("code",[_._v("script")]),_._v("脚本来说需要考虑同步异步，分别是加载以及执行的同步异步。假设"),e("code",[_._v("script")]),_._v("标签没有"),e("code",[_._v("defer or async")]),_._v("，那么在加载过程会阻塞"),e("code",[_._v("css or html")]),_._v("任何过程。所以"),e("code",[_._v("script")]),_._v("标签一般也是放在最后，保证"),e("code",[_._v("CSSDOM and HTMLDOM")]),_._v("先于"),e("code",[_._v("script")]),_._v("。当"),e("code",[_._v("script")]),_._v("文件加载完成之后，并不会立马执行，出于对 "),e("strong",[_._v("可能含有对"),e("code",[_._v("DOM")]),_._v("结构操作")]),_._v(" 操作的考虑。需要等待"),e("code",[_._v("cssdom htmldom")]),_._v("可以使用之后才能够执行。")])]),_._v(" "),e("p",[_._v("不过此时需要考虑"),e("a",{attrs:{href:""}},[_._v("Q&A - CSS和JS文件先后问题")]),_._v("，JS只会等待前面"),e("code",[_._v("CSS")]),_._v("文件。")]),_._v(" "),e("p",[e("strong",[_._v("Q&A1 - 如果JS下载完成，执行时间比较长，会影响dom吗？")])]),_._v(" "),e("p",[_._v("如同之前总计的"),e("code",[_._v("cssdom htmldom")]),_._v("都完成了，初始页面就已经可以看到了。")]),_._v(" "),e("blockquote",[e("p",[_._v("(我觉得可能是因为)这里有一个小细节，如果"),e("code",[_._v("script")]),_._v("在"),e("code",[_._v("cssdom or htmldom")]),_._v("解析完成之后也完成了下载，且执行时间比较久的话。可能会出现白屏的情况，就像是"),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/longtimescript.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("longtimescript.html"),e("OutboundLink")],1),_._v("那样。"),e("strong",[_._v("干扰页面呈现")])])]),_._v(" "),e("p",[_._v("好办法是是将这个长时间的过程异步执行，这个行为就好比模拟"),e("code",[_._v("script")]),_._v("长时间下载。此时不会白屏。"),e("strong",[_._v("不干扰页面呈现")])]),_._v(" "),e("p",[e("strong",[_._v("Q&A2 - JS和CSS书写顺序，同步异步关系")])]),_._v(" "),e("p",[_._v("如果"),e("code",[_._v("JS")]),_._v("前面存在"),e("code",[_._v("CSS")]),_._v("文件才会等待前面的"),e("code",[_._v("CSS")]),_._v("文件下载构建，而不会等待后面"),e("code",[_._v("CSS")]),_._v("文件。")]),_._v(" "),e("h3",{attrs:{id:"_1-3-3-加入script-含有defer-or-async"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-加入script-含有defer-or-async"}},[_._v("#")]),_._v(" 1.3.3. 加入SCRIPT(含有"),e("code",[_._v("defer or async")]),_._v(")")]),_._v(" "),e("ol",[e("li",[_._v("将"),e("code",[_._v("script")]),_._v("标签写到页面最后是优化手段之一")]),_._v(" "),e("li",[e("code",[_._v("defer & async")]),_._v("属性\n"),e("blockquote",[e("p",[_._v("共同特点 - 加载"),e("code",[_._v("JS")]),_._v("的时候 "),e("strong",[_._v("不干扰HTML(解析)，但是运行的时候还是会")])])])]),_._v(" "),e("li",[e("code",[_._v("defer")]),_._v(" - 延迟。\n"),e("ul",[e("li",[_._v("并在"),e("code",[_._v("HTML-DOM-TREE")]),_._v("解析完毕(一个叫"),e("code",[_._v("DOMContentLoaded")]),_._v("事件，在"),e("a",{attrs:{href:""}},[_._v("前置知识中有解析")]),_._v(")之前，且"),e("code",[_._v("JS")]),_._v("加载完毕之后执行(还要受到"),e("a",{attrs:{href:""}},[_._v("Q&A3")]),_._v("提到的等待前面的"),e("code",[_._v("CSSDOM")]),_._v(")")]),_._v(" "),e("li",[_._v("所以两个defer脚本的执行顺序是可以保证的。按书写顺序。")])])]),_._v(" "),e("li",[e("code",[_._v("async")]),_._v(" - 同步。\n"),e("ul",[e("li",[_._v("但是是在 "),e("strong",[_._v("async-JS加载完毕之后")]),_._v(" 执行(执行的时候还是干扰了dom，与"),e("code",[_._v("HTML-DOM-TREE")]),_._v("解析完毕无关)。")]),_._v(" "),e("li",[e("strong",[_._v("最好不依赖其他脚本")]),_._v("。")]),_._v(" "),e("li",[_._v("两个"),e("code",[_._v("async")]),_._v("脚本的执行顺序无法保证。")])])])]),_._v(" "),e("p",[e("strong",[_._v("defer async domcontentload之间联系")])]),_._v(" "),e("p",[_._v("见"),e("a",{attrs:{href:""}},[_._v("domcontentload")]),_._v("小结分析。")]),_._v(" "),e("blockquote",[e("p",[_._v("大致来说，也就是说"),e("code",[_._v("async")]),_._v("可能在"),e("code",[_._v("defer")]),_._v("之前或者之后都有可能。"),e("code",[_._v("async")]),_._v("在"),e("code",[_._v("DOMContentLoaded")]),_._v("发生之前之后都有可能。")])]),_._v(" "),e("p",[e("strong",[_._v("Q&A3 - "),e("code",[_._v("defer or async")]),_._v("JS和CSS书写顺序，同步异步关系")])]),_._v(" "),e("p",[e("strong",[_._v("Q&A2")]),_._v(" 对这一点也成立。")]),_._v(" "),e("p",[e("strong",[_._v("Q&A4 - normal defer or async下载的影响")])]),_._v(" "),e("p",[_._v("我们知道"),e("code",[_._v("defer or async")]),_._v("下载过程对"),e("code",[_._v("dom")]),_._v("解析不受到影响。那么如果在"),e("code",[_._v("cssdom htmldom")]),_._v("解析完成之后，"),e("code",[_._v("js")]),_._v("仍旧没有下载完？那么页面还会出现吗？")]),_._v(" "),e("p",[_._v("在"),e("a",{attrs:{href:"https://juejin.im/post/59c60691518825396f4f71a1",target:"_blank",rel:"noopener noreferrer"}},[_._v("参考链接"),e("OutboundLink")],1),_._v(" 存在一个"),e("code",[_._v("script")]),_._v("在"),e("code",[_._v("cssdom htmldom")]),_._v("都完成了之后，还是处于下载过程中。此时页面出现，单等到该"),e("code",[_._v("script")]),_._v("下载完成，并执行，可能会让原先页面有闪硕。")]),_._v(" "),e("p",[_._v("这一点和"),e("code",[_._v("defer normal async")]),_._v("的属性无关。")]),_._v(" "),e("p",[e("strong",[_._v("Q&A4 - defer or async下载是否会影响其他资源下载")])]),_._v(" "),e("p",[_._v("一般来说，我们只会提到"),e("code",[_._v("defer async")]),_._v("不会干扰"),e("code",[_._v("dom")]),_._v("解析，且会并行下载。但是下载的时候是否会影响其他资源下载？这取决于浏览器支持多少个资源并行下载，可能会影响，也可能不会。")]),_._v(" "),e("h3",{attrs:{id:"_1-3-4-题外话"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-4-题外话"}},[_._v("#")]),_._v(" 1.3.4. 题外话")]),_._v(" "),e("p",[e("strong",[_._v("注意0: - 一般将defer脚本放在最后是为了兼容ie")])]),_._v(" "),e("p",[e("strong",[_._v("注意1 - 现代浏览器已经支持的是并行下载script资源(在没有设置以上情况下)，但是在不开启"),e("code",[_._v("defer or async")]),_._v("会干扰其他资源下载")]),_._v("。")]),_._v(" "),e("p",[e("strong",[_._v("注意2 - chrome调试工具可以看到initator判断是谁发起了js请求。来自script标签说明是动态添加了脚本")]),_._v("。如果是来自"),e("code",[_._v("parser")]),_._v("就是直接写在html里面的。可以"),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/tree/master/Demos/async%26defer",target:"_blank",rel:"noopener noreferrer"}},[_._v("async&defer"),e("OutboundLink")],1),_._v("的例子。在这个例子中，可以得到：")]),_._v(" "),e("ol",{attrs:{start:"0"}},[e("li",[_._v("动态添加的脚本，默认开"),e("code",[_._v("async")])]),_._v(" "),e("li",[_._v("如果html文件很小，defer async脚本开始加载的事件相同。但是"),e("code",[_._v("async")]),_._v("执行要滞后在"),e("code",[_._v("defer")]),_._v("之后。至少在"),e("code",[_._v("chrome")]),_._v("里面是这样的。")]),_._v(" "),e("li",[_._v("而动态添加的脚本 "),e("strong",[_._v("开始加载的时间")]),_._v("一般是在"),e("code",[_._v("defer async or other")]),_._v("此类写死在"),e("code",[_._v("html")]),_._v("脚本之后的。")])]),_._v(" "),e("p",[_._v("这就是为什么"),e("a",{attrs:{href:"https://www.zhihu.com/question/20531965",target:"_blank",rel:"noopener noreferrer"}},[_._v("知乎-某答案network中js加载时间async延后defer那么多"),e("OutboundLink")],1)]),_._v(" "),e("h2",{attrs:{id:"_1-4-渲染再次-重新开始"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-渲染再次-重新开始"}},[_._v("#")]),_._v(" 1.4. 渲染再次 - 重新开始")]),_._v(" "),e("p",[_._v("当"),e("code",[_._v("CSS-DOM-TREE&HTML-DOM-TREE")]),_._v("组合完成开始渲染。")]),_._v(" "),e("p",[_._v("其实遇到了"),e("code",[_._v("JS")]),_._v("文件，如果其中改变了"),e("code",[_._v("HTML-DOM-TREE")]),_._v("或者是"),e("code",[_._v("CSS-DOM-TREE")]),_._v("。就不得不重新渲染！")]),_._v(" "),e("p",[_._v("渲染的程度取决于"),e("code",[_._v("JS")]),_._v("对"),e("code",[_._v("DOM")]),_._v("改变程度，有可能是部分，有可能是全部。")]),_._v(" "),e("h2",{attrs:{id:"_1-5-总结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-总结"}},[_._v("#")]),_._v(" 1.5. 总结")]),_._v(" "),e("ol",[e("li",[_._v("现代浏览器一般都支持并行下载(在不开启"),e("code",[_._v("defer or async")]),_._v("会干扰其他资源下载)，所以改变性能只剩下，下载过程和运行过程是否影响DOM")]),_._v(" "),e("li",[e("code",[_._v("DOMContentload")]),_._v("意味着"),e("code",[_._v("htmldom")]),_._v("解析完成")]),_._v(" "),e("li",[_._v("初始页面渲染和"),e("code",[_._v("cssdom htmldom")]),_._v("两个有关")]),_._v(" "),e("li",[e("code",[_._v("normal defer")]),_._v("一定保证在"),e("code",[_._v("DOMContentload")]),_._v("之前执行，而"),e("code",[_._v("async")]),_._v("无法保证，取决于下载速度和大小。所以"),e("code",[_._v("DOM")]),_._v("操作应该放在"),e("code",[_._v("defer or normal")]),_._v("，"),e("code",[_._v("async")]),_._v("应该是独立以及不涉及"),e("code",[_._v("dom")])]),_._v(" "),e("li",[_._v("如果是"),e("code",[_._v("link html js")]),_._v("这样的结构，有没有"),e("code",[_._v("normal defer or async")]),_._v("对初始页面渲染没影响。因为此时"),e("code",[_._v("cssdom htmldom")]),_._v("都已经解析完成了。之后运行代码可能会有闪烁。\n"),e("ul",[e("li",[_._v("之所以此时将"),e("code",[_._v("defer or async")]),_._v("的代码放在最后是为了兼容性考虑")]),_._v(" "),e("li",[_._v("如果浏览器支持"),e("code",[_._v("defer or async")]),_._v("的话，放在开头位置会优化体验")])])]),_._v(" "),e("li",[_._v("如果是"),e("code",[_._v("js link html")]),_._v("和"),e("code",[_._v("link js html")]),_._v("两种结构，注意"),e("code",[_._v("link")]),_._v("的影响。只有这两种情况下"),e("code",[_._v("defer or async")]),_._v("才能够表现出优势。")]),_._v(" "),e("li",[_._v("在"),e("code",[_._v("DOMContentload")]),_._v("和"),e("code",[_._v("load")]),_._v("之间还有加载其他资源(包括图片&JS)的过程。")])]),_._v(" "),e("h2",{attrs:{id:"_1-6-链接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-链接"}},[_._v("#")]),_._v(" 1.6. 链接")]),_._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"http://www.cnblogs.com/Peng2014/p/4687218.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("简单理解"),e("OutboundLink")],1)]),_._v(" "),e("li",[e("a",{attrs:{href:"https://www.jianshu.com/p/a32b890c29b1",target:"_blank",rel:"noopener noreferrer"}},[_._v("十分细致的解析"),e("OutboundLink")],1)]),_._v(" "),e("li",[e("a",{attrs:{href:"https://www.w3cplus.com/javascript/building-the-dom-faster-speculative-parsing-async-defer-and-preload.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("提到JS等待CSS"),e("OutboundLink")],1)]),_._v(" "),e("li",[e("a",{attrs:{href:"https://juejin.im/post/59c60691518825396f4f71a1",target:"_blank",rel:"noopener noreferrer"}},[_._v("CSS和JS&DOM大量测试"),e("OutboundLink")],1)]),_._v(" "),e("li",[e("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/25876048",target:"_blank",rel:"noopener noreferrer"}},[_._v("关于domcontentload"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);v.default=r.exports}}]);