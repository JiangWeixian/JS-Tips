(window.webpackJsonp=window.webpackJsonp||[]).push([[128],{446:function(a,t,n){"use strict";n.r(t);var s=n(0),o=Object(s.a)({},function(){var a=this,t=a.$createElement,n=a._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[n("h1",{attrs:{id:"组合模式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#组合模式","aria-hidden":"true"}},[a._v("#")]),a._v(" 组合模式")]),a._v(" "),n("blockquote",[n("p",[a._v("命令模式的升级版本")])]),a._v(" "),n("h2",{attrs:{id:"什么是组合模式？"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么是组合模式？","aria-hidden":"true"}},[a._v("#")]),a._v(" 什么是组合模式？")]),a._v(" "),n("p",[a._v("是命令模式的升级版本，或者准确来说是命令模式中 "),n("strong",[a._v("宏命令")]),a._v(" 的升级版本。")]),a._v(" "),n("p",[a._v("为什么这么说？")]),a._v(" "),n("p",[a._v("因为这就是它的设计目的。")]),a._v(" "),n("p",[a._v("实现"),n("strong",[a._v("宏命令的宏命令")]),a._v("组合，可以看"),n("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Books/blob/master/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F(Desgin-Patterns)/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F.md",target:"_blank",rel:"noopener noreferrer"}},[a._v("JS设计模式-命令模式-MacroCommand"),n("OutboundLink")],1),a._v("实现过程。")]),a._v(" "),n("h2",{attrs:{id:"组合模式特点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#组合模式特点","aria-hidden":"true"}},[a._v("#")]),a._v(" 组合模式特点")]),a._v(" "),n("p",[a._v("首先我们先看看它的使用过程来理解其特点：")]),a._v(" "),n("div",{staticClass:"language-JavaScript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 新建一个组合命令")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("var")]),a._v(" macroCommand1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("MacroCommand")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nmacroCommand1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v(" openTvCommand "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nmacroCommand1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v(" openSoundCommand "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 再新建另外一个组合命令")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("var")]),a._v(" macroCommand2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("MacroCommand")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nmacroCommand2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v(" closeDoorCommand "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nmacroCommand2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v(" openPcCommand "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nmacroCommand2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v(" openQQCommand "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 两个组合命令添加到一个组合中")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("var")]),a._v(" macroCommand "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("MacroCommand")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nmacroCommand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v(" openAcCommand "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nmacroCommand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v(" macroCommand1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nmacroCommand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v(" macroCommand2 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),n("p",[a._v("由于其中"),n("code",[a._v("execute")]),a._v("存在每个命令中；且"),n("code",[a._v("commandList")]),a._v("存在在"),n("code",[a._v("MacroCommand")]),a._v("中。")]),a._v(" "),n("p",[n("code",[a._v("execute")]),a._v("不是执行命令本身就是执行"),n("code",[a._v("commandList")]),a._v("。")]),a._v(" "),n("h2",{attrs:{id:"组合模式进一步拓展"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#组合模式进一步拓展","aria-hidden":"true"}},[a._v("#")]),a._v(" 组合模式进一步拓展")]),a._v(" "),n("ol",[n("li",[n("p",[a._v("每个命令基本都有相同属性和接口函数。")]),a._v(" "),n("p",[a._v("因此当使用"),n("code",[a._v("add")]),a._v("添加到"),n("code",[a._v("command")]),a._v("的时候就出现明显的树结构关系，也就是一个"),n("code",[a._v("command")]),a._v("嵌套其他命令，而其他命令中又有"),n("code",[a._v("commandList")])])]),a._v(" "),n("li",[n("p",[n("strong",[a._v("删除命令")]),a._v(" - 如何实现将一条命令从"),n("code",[a._v("commandList")]),a._v("中删除")])])]),a._v(" "),n("p",[a._v("首先我们了解实现删除从正面思路中难点，")]),a._v(" "),n("ul",[n("li",[a._v("我们无法定位"),n("code",[a._v("commandA")]),a._v("在"),n("code",[a._v("commandList")]),a._v("的位置。也就没办法直接删除，也就是说此时的结构没办法反应位置关系")])]),a._v(" "),n("p",[a._v("好消息是"),n("code",[a._v("commandList")]),a._v("是数组，删除起来比较容易("),n("code",[a._v("splice")]),a._v(")")]),a._v(" "),n("p",[a._v("针对这一点我们可以换一个思路：")]),a._v(" "),n("ul",[n("li",[a._v("我们从删除命令的本身执行"),n("code",[a._v("remove")]),a._v("，然后找到其"),n("code",[a._v("parent")]),a._v("，对"),n("code",[a._v("parent")]),a._v("下面的"),n("code",[a._v("commandList")]),a._v("进行操作。\n"),n("ol",[n("li",[a._v("因此我们对"),n("strong",[a._v("命令")]),a._v("(是"),n("code",[a._v("MacroCommand or openTvCommand")]),a._v(")添加"),n("code",[a._v("parent")]),a._v("。每次添加命令的时候("),n("strong",[a._v("是"),n("code",[a._v("MacroCommand")]),a._v("而不是"),n("code",[a._v("openTvCommand")])]),a._v(")，对子命令("),n("strong",[n("code",[a._v("MacroCommand or openTvCommand")])]),a._v(")指向"),n("code",[a._v("parent")]),a._v("属性赋值。")]),a._v(" "),n("li",[a._v("删除 - 从"),n("code",[a._v("parent.commadList")]),a._v("中找到该命令，然后"),n("code",[a._v("splice")])])])])])])},[],!1,null,null,null);t.default=o.exports}}]);