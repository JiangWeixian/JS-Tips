(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{222:function(t,a,s){t.exports=s.p+"assets/img/script.59d63189.png"},471:function(t,a,s){"use strict";s.r(a);var e=s(0),_=Object(e.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"http-输入地址到显示页面"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http-输入地址到显示页面"}},[t._v("#")]),t._v(" HTTP - 输入地址到显示页面")]),t._v(" "),e("blockquote",[e("p",[t._v("包含了现代浏览器如何优化(优化JS/CSS加载)")])]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#http---%E8%BE%93%E5%85%A5%E5%9C%B0%E5%9D%80%E5%88%B0%E6%98%BE%E7%A4%BA%E9%A1%B5%E9%9D%A2"}},[t._v("HTTP - 输入地址到显示页面")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#11-%E6%A6%82%E8%BF%B0"}},[t._v("1.1. 概述")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#111-%E5%BB%BA%E7%AB%8B%E8%BF%9E%E6%8E%A5%E6%A6%82%E8%BF%B0"}},[t._v("1.1.1. 建立连接概述")])])])]),t._v(" "),e("li",[e("a",{attrs:{href:"#12-%E4%BC%98%E5%8C%96"}},[t._v("1.2. 优化")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#121-dns%E4%BC%98%E5%8C%96"}},[t._v("1.2.1. DNS优化")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#122-css%E4%BC%98%E5%8C%96"}},[t._v("1.2.2. CSS优化")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#123-js%E4%BC%98%E5%8C%96"}},[t._v("1.2.3. JS优化")])])])]),t._v(" "),e("li",[e("a",{attrs:{href:"#13-%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5"}},[t._v("1.3. 参考链接")])])])])]),t._v(" "),e("h2",{attrs:{id:"_1-1-概述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-概述"}},[t._v("#")]),t._v(" 1.1. 概述")]),t._v(" "),e("p",[t._v("当我们请求地址，获得了"),e("code",[t._v("html")]),t._v("中 "),e("strong",[t._v("标签")]),t._v("包括"),e("code",[t._v("dom&link")]),t._v("，"),e("code",[t._v("link")]),t._v("中"),e("code",[t._v("css")]),t._v("文件并没有下载，而 "),e("strong",[e("code",[t._v("dom")]),t._v("元素已经跟随"),e("code",[t._v(".html")]),t._v("文件下载回来了。")]),t._v(" 等待样式文件下载完毕参与构建。")]),t._v(" "),e("p",[t._v("页面加载是否快速，涉及到以下几个方面。这篇文章总结的也只是 "),e("strong",[t._v("第五点-CSS&HTML&JS对页面渲染的影响！")]),t._v(" 以上从上到下也就是输入"),e("code",[t._v("url")]),t._v("到页面出现所发生的一切。")]),t._v(" "),e("ol",[e("li",[t._v("DNS 查询 - 查询"),e("code",[t._v("www.baidu.com")]),t._v("对应的"),e("code",[t._v("ip")]),t._v("地址。因为路由器需要知道向那个ip地址发送。")]),t._v(" "),e("li",[t._v("TCP 连接 - 只有tcp建立了链接才能够建立http")]),t._v(" "),e("li",[t._v("HTTP 请求即响应")]),t._v(" "),e("li",[t._v("服务器响应 - 对于响应结果进一步处理方式有，保存"),e("code",[t._v("cookie")]),t._v("以及缓存资源。如果资源已经缓存了(且没有过期)，那么就本地读取。")]),t._v(" "),e("li",[t._v("客户端渲染")])]),t._v(" "),e("h3",{attrs:{id:"_1-1-1-建立连接概述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-1-建立连接概述"}},[t._v("#")]),t._v(" 1.1.1. 建立连接概述")]),t._v(" "),e("ol",[e("li",[t._v("输入URL地址，尝试发起HTTP请求，此时没有建立TCP连接，无法发送数据")]),t._v(" "),e("li",[t._v("尝试建立TCP连接，发现没有目标IP地址")]),t._v(" "),e("li",[t._v("对url进行DNS解析，得到目标IP地址。")])]),t._v(" "),e("p",[t._v("得到IP之后，就是数据发送的过程。那么HTTP数据封装到TCP数据中，TCP数据分装到IP数据中。如下图：")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/JiangWeixian/JS-Tips/master/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/img/%E8%BE%93%E5%85%A5URL%E5%85%A8%E8%BF%87%E7%A8%8B.png",alt:"数据封装概述"}})]),t._v(" "),e("p",[e("strong",[t._v("全部具体过程见参考链接！")])]),t._v(" "),e("h2",{attrs:{id:"_1-2-优化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-优化"}},[t._v("#")]),t._v(" 1.2. 优化")]),t._v(" "),e("p",[e("code",[t._v("HTML")]),t._v("的标签(指的是"),e("code",[t._v("div p etc...")]),t._v(")我们无法优化，"),e("strong",[t._v("当然如果能够使用最少元素构建是最好的，避免较多的标签嵌套")]),t._v("。我们只能够从"),e("code",[t._v("DNS&CSS&JS")]),t._v("角度触发。")]),t._v(" "),e("h3",{attrs:{id:"_1-2-1-dns优化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1-dns优化"}},[t._v("#")]),t._v(" 1.2.1. DNS优化")]),t._v(" "),e("p",[t._v("见"),e("a",{attrs:{href:"http://bubkoo.com/2015/11/19/prefetching-preloading-prebrowsing/",target:"_blank",rel:"noopener noreferrer"}},[t._v("文章1"),e("OutboundLink")],1),t._v("or"),e("a",{attrs:{href:"https://github.com/GeoffZhu/geoffzhu.github.io/issues/2",target:"_blank",rel:"noopener noreferrer"}},[t._v("文章2"),e("OutboundLink")],1),t._v(" - 里面对图片等资源的预加载。")]),t._v(" "),e("h3",{attrs:{id:"_1-2-2-css优化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2-css优化"}},[t._v("#")]),t._v(" 1.2.2. CSS优化")]),t._v(" "),e("p",[t._v("页面中的"),e("code",[t._v("CSS")]),t._v("从开始到渲染涉及到三个过程：")]),t._v(" "),e("ol",[e("li",[t._v("加载")]),t._v(" "),e("li",[t._v("构建"),e("code",[t._v("CSS-DOM-TREE")])]),t._v(" "),e("li",[t._v("渲染")])]),t._v(" "),e("p",[t._v("其中前两个是可以优化的。")]),t._v(" "),e("p",[e("strong",[t._v("加载优化")])]),t._v(" "),e("p",[t._v("合并"),e("code",[t._v("CSS")]),t._v("文件可以减少"),e("code",[t._v("HTTP")]),t._v("请求，可以优化。"),e("strong",[t._v("但是假设我们有两个个样式文件，其中一个全局(无论什么条件下都会起作用)，其余一个是"),e("code",[t._v("media query")]),t._v("作用在屏幕尺寸改变的时候")])]),t._v(" "),e("p",[t._v("明显后面那个是不需要再页面加载的时候就加载进来的。可以比第一个稍微延迟一点。因此我们可以通过")]),t._v(" "),e("div",{staticClass:"language-HTML extra-class"},[e("pre",{pre:!0,attrs:{class:"language-html"}},[e("code",[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("index.css"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("stylesheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("print.css"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("stylesheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("media")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("print"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("other.css"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("stylesheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("media")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("(min-width: 30em) and (orientation: landscape)"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),e("p",[t._v("后面两个添加了"),e("code",[t._v("meida")]),t._v("，所以会延迟加载，也就是当加载好"),e("code",[t._v("index.css")]),t._v("之后，就会开始进行"),e("code",[t._v("HTML-DOM-TREE")]),t._v("构建。而后面两个会同步加载，但是不会影响"),e("code",[t._v("CSS-DOM-TREE&HTML-DOM-TREE")]),t._v("构建。至少再页面开始的时候是这样的。")]),t._v(" "),e("p",[e("strong",[t._v("构建优化")])]),t._v(" "),e("ol",[e("li",[e("p",[t._v("给需要标签添加"),e("code",[t._v("class")]),t._v("是优化重要步骤 - 此时要涉及到"),e("code",[t._v("CSS-DOM-TREE")]),t._v("的构建规则，如果看过"),e("code",[t._v("JQ")]),t._v("实现其选择器的源码的话，就会发现它 "),e("strong",[t._v("并不是从左到右边的选择")]),t._v("，即当"),e("code",[t._v(".class a")]),t._v("，并不是找到"),e("code",[t._v(".class")]),t._v("元素，然后再再其中找到"),e("code",[t._v("a")]),t._v("元素。")]),t._v(" "),e("p",[t._v("而是遵循从右到左原则，先找到"),e("code",[t._v("a")]),t._v("元素然后再由上找到"),e("code",[t._v(".class")]),t._v("元素。浏览器也是这样的规则。")]),t._v(" "),e("p",[t._v("所以页面众多"),e("code",[t._v("a")]),t._v("标签，却只有"),e("code",[t._v(".class")]),t._v("元素。先是找到"),e("code",[t._v("a")]),t._v("标签，由于"),e("code",[t._v("a")]),t._v("标签过多，这一步很影响，所以给需要的"),e("code",[t._v("a")]),t._v("标签添加"),e("code",[t._v("class")]),t._v("是优化重要步骤。")])])]),t._v(" "),e("p",[t._v("这部分的"),e("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/29418126",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考链接"),e("OutboundLink")],1)]),t._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[e("code",[t._v("CSS-DOM-TREE")]),t._v("树结构优化 - 首先这是个书结构，所以层级不要太深，树结构不要太复杂能够优化解析。\n"),e("ul",[e("li",[t._v("选择器不要太多，比如说从"),e("code",[t._v("html")]),t._v("标签开始选择一个"),e("code",[t._v("a")]),t._v("标签")]),t._v(" "),e("li",[t._v("不要使用比较短的"),e("code",[t._v("class-name")])])])])]),t._v(" "),e("p",[e("a",{attrs:{href:"https://www.oschina.net/translate/writing-efficient-css-selectors",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考-编写高效的CSS"),e("OutboundLink")],1),t._v(" - 不过也要从适合自己角度触发。")]),t._v(" "),e("h3",{attrs:{id:"_1-2-3-js优化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-3-js优化"}},[t._v("#")]),t._v(" 1.2.3. JS优化")]),t._v(" "),e("p",[t._v("一般来说JS在下载和运行过程中都会干扰到HTML解析。所以一般会放在最后。")]),t._v(" "),e("p",[e("img",{attrs:{src:s(222),alt:"script干扰"}})]),t._v(" "),e("p",[t._v("和"),e("code",[t._v("CSS")]),t._v("一样，页面中的"),e("code",[t._v("JS")]),t._v("从开始到渲染涉及到三个过程：")]),t._v(" "),e("ol",[e("li",[t._v("加载")]),t._v(" "),e("li",[t._v("运行")]),t._v(" "),e("li",[t._v("渲染")])]),t._v(" "),e("p",[e("strong",[t._v("运行优化 - "),e("code",[t._v("defer or async")])])]),t._v(" "),e("p",[t._v("完整部分见"),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/Browser-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93%E5%8E%9F%E7%90%86.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("Browser-浏览器渲染过程"),e("OutboundLink")],1)]),t._v(" "),e("ol",[e("li",[t._v("无论是否有"),e("code",[t._v("defer or async")]),t._v("属性，将"),e("code",[t._v("script")]),t._v("标签写到页面最后是相对稳妥的做法。\n"),e("ul",[e("li",[t._v("没有兼容性问题")]),t._v(" "),e("li",[t._v("优化不阻塞DOM(相对于"),e("code",[t._v("normal script")]),t._v("写在头部)")])])]),t._v(" "),e("li",[e("code",[t._v("defer & async")]),t._v("属性优势只会 "),e("strong",[t._v("将"),e("code",[t._v("script")]),t._v("标签写在头部的时候才会看出来")]),t._v(" "),e("ul",[e("li",[t._v("共同特点 - 加载"),e("code",[t._v("JS")]),t._v("的时候 "),e("strong",[t._v("不干扰HTML解析，但是运行的时候还是会")])]),t._v(" "),e("li",[e("code",[t._v("defer")]),t._v(" - 延迟。"),e("strong",[t._v("并在"),e("code",[t._v("HTML-DOM-TREE")]),t._v("解析完毕(一个叫"),e("code",[t._v("DOMContentLoaded")]),t._v("事件)之前，且"),e("code",[t._v("JS")]),t._v("加载完毕之后执行。")]),t._v(" 而且，所以两个defer脚本的执行顺序是可以保证的。按书写顺序。")]),t._v(" "),e("li",[e("code",[t._v("async")]),t._v(" - 同步。但是是在 "),e("strong",[t._v("JS加载完毕之后")]),t._v(" 执行(执行的时候还是干扰了dom)。并不会等待"),e("code",[t._v("HTML-DOM-TREE")]),t._v("解析完毕。"),e("strong",[t._v("不依赖其他脚本")]),t._v("。两个"),e("code",[t._v("async")]),t._v("脚本的执行顺序无法保证。")])])]),t._v(" "),e("li",[t._v("也就是说"),e("code",[t._v("async")]),t._v("可能在"),e("code",[t._v("defer")]),t._v("之前或者之后都有可能。")])]),t._v(" "),e("p",[e("strong",[t._v("注意0: - 一般将defer脚本放在最后是为了兼容ie")])]),t._v(" "),e("p",[e("strong",[t._v("注意1 - 现代浏览器已经支持的是并行下载script资源(在没有设置以上情况下)，但是会干扰其他资源下载")]),t._v("。也就是说上面两个其实设置的执行顺序。")]),t._v(" "),e("p",[e("strong",[t._v("注意2 - chrome调试工具可以看到initator判断是谁发起了js请求。来自script标签说明是动态添加了脚本")]),t._v("。如果是来自"),e("code",[t._v("parser")]),t._v("就是直接写在html里面的。可以"),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/tree/master/demos/async%26defer",target:"_blank",rel:"noopener noreferrer"}},[t._v("async&defer"),e("OutboundLink")],1),t._v("的例子。在这个例子中，可以得到：")]),t._v(" "),e("ol",{attrs:{start:"0"}},[e("li",[t._v("动态添加的脚本，默认开"),e("code",[t._v("async")])]),t._v(" "),e("li",[t._v("如果html文件很小，defer async脚本开始加载的事件相同。但是"),e("code",[t._v("async")]),t._v("执行要滞后在"),e("code",[t._v("defer")]),t._v("之后。至少在"),e("code",[t._v("chrome")]),t._v("里面是这样的。")]),t._v(" "),e("li",[t._v("而动态添加的脚本 "),e("strong",[t._v("开始加载的时间")]),t._v("一般是在"),e("code",[t._v("defer async or other")]),t._v("此类写死在"),e("code",[t._v("html")]),t._v("脚本之后的。")])]),t._v(" "),e("p",[t._v("这就是为什么"),e("a",{attrs:{href:"https://www.zhihu.com/question/20531965",target:"_blank",rel:"noopener noreferrer"}},[t._v("知乎-某答案network中js加载时间async延后defer那么多"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("strong",[t._v("JS与DOM")])]),t._v(" "),e("p",[t._v("更多细节可看"),e("a",{attrs:{href:"https://github.com/JiangWeixian/JS-Tips/blob/master/docs/HTML/HTML-DOM%E4%BC%98%E5%8C%96%E6%8C%87%E5%8D%97.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTML-DOM优化指南"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("指的是对"),e("code",[t._v("DOM")]),t._v("修改这一部分")]),t._v(" "),e("p",[t._v("不要逐条修改"),e("code",[t._v("css")]),t._v("样式，将改变的样式写到一起，一起修改；也可以改变"),e("code",[t._v("classname")]),t._v("实现样式的变化。")]),t._v(" "),e("h2",{attrs:{id:"_1-3-参考链接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-参考链接"}},[t._v("#")]),t._v(" 1.3. 参考链接")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://juejin.im/entry/58ce00c5ac502e00589b4bde",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTTP-OSI建立链接全过程"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://juejin.im/post/5872309261ff4b005c4580d4",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTTP-建立链接过程更为详细"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=_.exports}}]);