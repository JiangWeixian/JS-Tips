(window.webpackJsonp=window.webpackJsonp||[]).push([[241],{595:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"object-create"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#object-create"}},[t._v("#")]),t._v(" Object.create")]),t._v(" "),s("blockquote",[s("p",[t._v("并不完全是 "),s("strong",[t._v("浅层复制")]),t._v("。")])]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#objectcreate"}},[t._v("Object.create")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#11-%E7%BB%93%E8%AE%BA"}},[t._v("1.1. 结论")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#12-%E5%85%88%E7%9C%8B%E4%BE%8B%E5%AD%90"}},[t._v("1.2. 先看例子")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#13-%E5%92%8Cobjectassign"}},[t._v("1.3. 和Object.assign")])])])])]),t._v(" "),s("h2",{attrs:{id:"_1-1-结论"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-结论"}},[t._v("#")]),t._v(" 1.1. 结论")]),t._v(" "),s("p",[t._v("这个方法是浅层赋值。")]),t._v(" "),s("h2",{attrs:{id:"_1-2-先看例子"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-先看例子"}},[t._v("#")]),t._v(" 1.2. 先看例子")]),t._v(" "),s("div",{staticClass:"language-JavaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" target "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" clone "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Object"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("很特别的一点在于，其实Object.create赋值的不是属性，**prototype级别操作。**看里面的源码就明白了：")]),t._v(" "),s("div",{staticClass:"language-JavaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" Object"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("create "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"function"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    Object"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("create")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("proto")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("F")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("F")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" proto"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("F")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("也就是说赋值过来的方法是在"),s("code",[t._v("clone")]),t._v("的"),s("code",[t._v("__proto__")]),t._v("上。"),s("strong",[t._v("这是和"),s("code",[t._v("assign")]),t._v("不同的一点。")]),t._v("，而且其实"),s("code",[t._v("clone")]),t._v("是空的，赋值结果都在"),s("code",[t._v("__proto__")]),t._v("，这也是为什么这个方法一般用在继承上。")]),t._v(" "),s("div",{staticClass:"language-JavaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// clone")]),t._v("\n__proto__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \na"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("但是我们知道的是一个对象查询属性如果在本身上找不到，就会去"),s("code",[t._v("__proto__")]),t._v("上查找。就是"),s("code",[t._v("clone.a")]),t._v("是能够获取的数值的原因。")]),t._v(" "),s("p",[t._v("而且你对比"),s("a",{attrs:{href:""}},[t._v("继承")]),t._v("，还可以发现如果在子类上"),s("code",[t._v("child.prototype.name=xx")]),t._v("，如果"),s("code",[t._v("parent.prototype.name")]),t._v("存在，那么"),s("code",[t._v("child.prototype.name")]),t._v("并不是是覆盖操作，而是在自己上面 "),s("strong",[t._v("添加了一个name")]),t._v("属性。那么对"),s("code",[t._v("clone")]),t._v("来说，"),s("code",[t._v("clone.a=2")]),t._v("就会变成：")]),t._v(" "),s("div",{staticClass:"language-JavaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// clone")]),t._v("\na"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n__proto__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \na"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("strong",[t._v("这就是为什么看起来这是浅层赋值")])]),t._v(" "),s("p",[t._v("但是如果"),s("code",[t._v("clone.b.d=2")]),t._v("，结果就又会不同：")]),t._v(" "),s("div",{staticClass:"language-JavaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// clone")]),t._v("\na"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n__proto__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \na"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("而且修改了target，"),s("strong",[t._v("这就是为什么不是深层次。")])]),t._v(" "),s("p",[t._v("(以下是我自己理解的)")]),t._v(" "),s("p",[t._v("我们只能够得到"),s("code",[t._v("getter setter")]),t._v("JavaScript处理不同，"),s("code",[t._v("get")]),t._v("要找父级，"),s("code",[t._v("set")]),t._v("只在自己属性。")]),t._v(" "),s("p",[t._v("但是"),s("code",[t._v("clone.b.d=2")]),t._v("原因是声明，分为"),s("code",[t._v("clone.b")]),t._v("以及"),s("code",[t._v(".d")]),t._v("，"),s("strong",[t._v("前者是"),s("code",[t._v("get")]),t._v("，后者才是"),s("code",[t._v("set")])]),t._v("。所以才会修改"),s("code",[t._v("target")]),t._v("。")]),t._v(" "),s("p",[t._v("但是如果你先"),s("code",[t._v("clone.b = {}")]),t._v("，然后再"),s("code",[t._v("clone.b.d=2")]),t._v("情况就又不同了。此时分为"),s("code",[t._v("clone.b")]),t._v("以及"),s("code",[t._v(".d")]),t._v("。"),s("strong",[t._v("clone.b")]),t._v("已经在本省属性上找到了。")]),t._v(" "),s("h2",{attrs:{id:"_1-3-和object-assign"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-和object-assign"}},[t._v("#")]),t._v(" 1.3. 和Object.assign")]),t._v(" "),s("p",[t._v("对比利用"),s("code",[t._v("Object.assign")]),t._v("实现"),s("a",{attrs:{href:""}},[t._v("深度复制")]),t._v("简要的实现。")]),t._v(" "),s("p",[t._v("可以发现"),s("code",[t._v("create")]),t._v("将数据复制到"),s("code",[t._v("__proto__")]),t._v("，而"),s("code",[t._v("assign")]),t._v("将数据复制到"),s("code",[t._v("__proto__")]),t._v("之外。")]),t._v(" "),s("p",[t._v("而复制到"),s("code",[t._v("__proto__")]),t._v("上意味着如果修改"),s("code",[t._v("target")]),t._v("，那么"),s("code",[t._v("clone")]),t._v("就会同步修改(因为"),s("code",[t._v("target")]),t._v("作为它的父类)。如果修改"),s("code",[t._v("clone")]),t._v("(依照上诉的方法)，则不一定完全同步改变"),s("code",[t._v("target")]),t._v("。")]),t._v(" "),s("p",[s("strong",[t._v("结论就是：")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("create")]),t._v("复制"),s("code",[t._v("prototype")]),t._v("上面的方法")]),t._v(" "),s("li",[s("code",[t._v("assign")]),t._v("复制一般属性")])]),t._v(" "),s("p",[s("strong",[t._v("如果想要一起复制，在"),s("a",{attrs:{href:""}},[t._v("ES6-对象扩展中有一个方法")])])]),t._v(" "),s("div",{staticClass:"language-JavaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("Object"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("assign")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    Object"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Object"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPrototypeOf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("， "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 复制了prototype部分，但是除了这个之外没有其他")]),t._v("\n    obj "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 复制一般属性")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);