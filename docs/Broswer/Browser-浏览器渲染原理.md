---
tag: script
---

# æµè§ˆå™¨æ¸²æŸ“åŸç†

- [æµè§ˆå™¨æ¸²æŸ“åŸç†](#æµè§ˆå™¨æ¸²æŸ“åŸç†)
  - [TL;DR](#tldr)
  - [å‰ç½®çŸ¥è¯†](#å‰ç½®çŸ¥è¯†)
    - [æ„å»º&æ¸²æŸ“](#æ„å»ºæ¸²æŸ“)
      - [æ„å»º](#æ„å»º)
      - [æ¸²æŸ“](#æ¸²æŸ“)
    - [DOMContentload&load](#domcontentloadload)
  - [æµè§ˆå™¨æ¸²æŸ“æµç¨‹](#æµè§ˆå™¨æ¸²æŸ“æµç¨‹)
    - [å‡è®¾æ²¡æœ‰SCRIPT](#å‡è®¾æ²¡æœ‰script)
    - [scriptçš„æ‰§è¡Œé¡ºåº](#scriptçš„æ‰§è¡Œé¡ºåº)
  - [QA](#qa)
    - [å†·çŸ¥è¯†](#å†·çŸ¥è¯†)
  - [æ¸²æŸ“é‡æ–°å¼€å§‹](#æ¸²æŸ“é‡æ–°å¼€å§‹)
  - [ä¼˜åŒ–](#ä¼˜åŒ–)
  - [é“¾æ¥](#é“¾æ¥)

## TL;DR

1. ç°ä»£æµè§ˆå™¨ä¸€èˆ¬éƒ½æ”¯æŒå¹¶è¡Œä¸‹è½½(åœ¨ä¸å¼€å¯`defer or async`ä¼šå¹²æ‰°å…¶ä»–èµ„æºä¸‹è½½)ï¼Œæ‰€ä»¥æ”¹å˜æ€§èƒ½åªå‰©ä¸‹ï¼Œä¸‹è½½è¿‡ç¨‹å’Œè¿è¡Œè¿‡ç¨‹æ˜¯å¦å½±å“DOM
2. `DOMContentload`æ„å‘³ç€`htmldom`è§£æå®Œæˆ = `html + normal and defer script`
3. `normal and defer`ä¸€å®šä¿è¯åœ¨`DOMContentload`ä¹‹å‰æ‰§è¡Œï¼Œè€Œ`async`æ— æ³•ä¿è¯ï¼Œå–å†³äºä¸‹è½½é€Ÿåº¦å’Œå¤§å°ã€‚
4. åˆå§‹é¡µé¢æ¸²æŸ“ = `cssdom htmldom`
5. å¦‚æœæ˜¯`link html js`è¿™æ ·çš„ç»“æ„ï¼Œæœ‰æ²¡æœ‰`normal and defer or async`å¯¹**åˆå§‹é¡µé¢æ¸²æŸ“**æ²¡å½±å“ï¼Œè¡¨ç°å’Œ`normal scipt`æ²¡å•¥åŒºåˆ«ã€‚å› ä¸ºæ­¤æ—¶`cssdom htmldom`éƒ½å·²ç»è§£æå®Œæˆäº†ã€‚ä¹‹åè¿è¡Œä»£ç å¯èƒ½ä¼šæœ‰é—ªçƒã€‚æ­¤æ—¶æ˜¯äºŒæ¬¡æ¸²æŸ“ã€‚
    * ä¹‹æ‰€ä»¥æ­¤æ—¶å°†`defer or async`çš„ä»£ç æ”¾åœ¨æœ€åæ˜¯ä¸ºäº†å…¼å®¹æ€§è€ƒè™‘
    * å¦‚æœæµè§ˆå™¨æ”¯æŒ`defer or async`çš„è¯ï¼Œæ”¾åœ¨å¼€å¤´ä½ç½®ä¼šä¼˜åŒ–ä½“éªŒã€‚å› ä¸ºä¼˜å…ˆè§£æåˆ°äº†`script`ã€‚
6. å¦‚æœæ˜¯`js link html`å’Œ`link js html`ä¸¤ç§ç»“æ„ï¼Œæ³¨æ„`link`çš„å½±å“ã€‚åªæœ‰è¿™ä¸¤ç§æƒ…å†µä¸‹`defer or async`æ‰èƒ½å¤Ÿè¡¨ç°å‡ºä¼˜åŠ¿ã€‚
7. `js`ä¼šç­‰å¾…å‰é¢çš„`css`
8. åœ¨`DOMContentload`å’Œ`load`ä¹‹é—´è¿˜æœ‰åŠ è½½å…¶ä»–èµ„æº(åŒ…æ‹¬å›¾ç‰‡&JS)çš„è¿‡ç¨‹ã€‚

å› æ­¤å¯¹äºç°ä»£æµè§ˆå™¨åˆç†çš„é¡µé¢ç»“æ„ä¸º

```html
script defer or async
link
html
script normal
```

## å‰ç½®çŸ¥è¯†

> **ğŸ’¡ NOTE**  
åªæœ‰å°†æ ‡ç­¾åœ¨æ–‡ä»¶å¤´éƒ¨æ‰èƒ½å¤Ÿä½“ä¼šåˆ°ä¼˜åŠ¿ã€‚

* `defer` - è§£æ`html`çš„æ—¶å€™ï¼Œä¸€èµ·ä¸‹è½½ï¼Œ**åŒæ—¶`html`è§£æå®Œæ¯•ä¹‹å**ï¼Œæ‰§è¡Œ`js`
* `async` - è§£æ`html`çš„æ—¶å€™ï¼Œä¸€èµ·ä¸‹è½½ï¼Œ**ä¸‹è½½å®Œæ¯•ä¹‹å**ï¼Œæ‰§è¡Œ`js`

åŒæ—¶å¤šä¸ª`defer`æ ‡ç­¾æ‰§è¡ŒæŒ‰é¡ºåºæ‰§è¡Œï¼Œ`async`å¹¶ä¸ä¿è¯ï¼Œè°å…ˆä¸‹è½½å®Œä¹‹åå†æ‰§è¡Œã€‚

### æ„å»º&æ¸²æŸ“

#### æ„å»º

ç”±æ–‡ä»¶å¾—åˆ°æ•°æ®ç»“æ„ã€‚æŒ‡çš„æ˜¯è§£æä¸‹è½½å¾—åˆ°çš„`html`æ–‡ä»¶ã€‚

#### æ¸²æŸ“

å°±æ˜¯å¯ä»¥çœ‹åˆ°å‘ˆç°çš„ç”»é¢ - æ˜¯`cssdom and htmldom`ç»„åˆæ„æˆçš„è¡Œä¸ºã€‚æ¥ä¸‹æ¥åˆ†æä¸€ä¸‹`link html script`ä¸åŒé¡ºåºå¯¹æ¸²æŸ“ç»“æœçš„å½±å“ã€‚

**å¦‚æœæ˜¯`link html script`è¿™æ ·çš„é¡ºåºã€‚**

- **é¡µé¢**ä¸­ä¸º`link html (no defer async)script`çš„æ„æˆã€‚åªä¼šç­‰å¾…å‰é¢ä¸¤ä¸ªå®Œæˆå°±ä¼šå‡ºç°é¡µé¢ã€‚è§[(no defer async)script.html](https://github.com/JiangWeixian/JS-Tips/blob/master/docs/docs/Broswer/HTML/script.html)æµ‹è¯•

å› æ­¤å¦‚æœ`script`ä¸­å­˜åœ¨ä¿®æ”¹æ ·å¼ä»£ç ï¼Œå¯èƒ½ä¼šå‡ºç°é¡µé¢é‡æ–°ç»˜åˆ¶ã€‚

- å¦‚æœ`link html (async defer)script`åªä¼šç­‰å¾…å‰é¢ä¸¤ä¸ªå®Œæˆå°±ä¼šå‡ºç°é¡µé¢ï¼Œ[(è°ƒæ•´ç½‘ç»œä¸ºslow-3g)defer-script.html](https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/defer-script.html)å’Œ[(è°ƒæ•´ç½‘ç»œä¸ºslow-3g)async-script.html](https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/async-script.html)éƒ½æ˜¯ä¸€æ ·çš„æƒ…å†µã€‚

è¯´æ˜äº†å¦‚æœæ˜¯`link html script`è¿™æ ·çš„é¡ºåºã€‚`defer async`å¯¹ **åˆå§‹åŒ–**æ¸²æŸ“ç»“æœçš„å½±å“ä¸å¤§ã€‚

**å¦‚æœæ˜¯`link script html`è¿™æ ·çš„é¡ºåºã€‚**

- å¦‚æœé¡µé¢ä¸­ä¸º`link html (no defer async)script`çš„æ„æˆã€‚é‚£ä¹ˆé¡µé¢æ¸²æŸ“éœ€è¦ç­‰å¾…è¿™ä¸‰ä¸ªå…¨éƒ¨å®Œæˆã€‚è§[(no defer async)normal-scriptä½ç½®æµ‹è¯•.html](https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/normal-script%E9%A1%B5%E9%9D%A2%E4%BD%8D%E7%BD%AE%E6%B5%8B%E8%AF%95.html)

- å¦‚æœ`link html (defer)script`åªä¼šç­‰å¾…å‰é¢ä¸¤ä¸ªå®Œæˆå°±ä¼šå‡ºç°é¡µé¢([(è°ƒæ•´ç½‘ç»œä¸ºslow-3g)defer-scriptä½ç½®æµ‹è¯•.html](https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/defer-script%E9%A1%B5%E9%9D%A2%E4%BD%8D%E7%BD%AE%E6%B5%8B%E8%AF%95.html))ã€‚

- å¦‚æœæ˜¯`async`ç”±äºåŠ è½½å®Œæˆæ—¶é—´ä¸ä¸€è‡´ï¼Œå¯èƒ½è¿˜æ˜¯ä¼šå‡ºç°é˜»å¡çš„æƒ…å†µ([(è°ƒæ•´ç½‘ç»œä¸ºslow-3g)async-scriptä½ç½®æµ‹è¯•.html](https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/async-script%E9%A1%B5%E9%9D%A2%E4%BD%8D%E7%BD%AE%E6%B5%8B%E8%AF%95.html)éƒ½æ˜¯æ¯”è¾ƒå¤§çš„æ–‡ä»¶ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰å‡ºç°é˜»å¡æƒ…å†µ)

è¯´æ˜å¦‚æœ`script`ä½ç½®æå‰ï¼Œå°±ä¼šä½“ç°å‡º`defer and script`ç‰¹æ€§ã€‚

### DOMContentload&load

[alloyteamå‚è€ƒé“¾æ¥](http://www.alloyteam.com/2014/03/effect-js-css-and-img-event-of-domcontentloaded/)

é¡ºåºä¸º`DOMContentload->å›¾ç‰‡->load`

* `DOMContentload` - `HTMLDOM`è§£æå®Œæ¯•å°±ä¼šè§¦å‘(ä¸éœ€è¦ç­‰å¾…æ ·å¼è¡¨å›¾ç‰‡ï¼Œæ ·å¼è¡¨ä¸‹è½½å’Œè§£æå±äºåŒæ­¥è¿‡ç¨‹ï¼Œ**ä½†æ˜¯éœ€è¦ç­‰å¾…æ‰€æœ‰çš„(normal and defer not async)JSæ–‡ä»¶æ‰§è¡Œå®Œæˆ**)ã€‚è¯´æ˜äº†`async`å¯èƒ½åœ¨`DOMContentload`ä¹‹å‰æˆ–è€…ä¹‹åã€‚
* `load` - åœ¨ `DOMContentload` è§¦å‘ä¹‹åï¼ŒåŠ è½½å®Œæˆæ‰€æœ‰èµ„æº(åŒ…æ‹¬æ ·å¼è¡¨å›¾ç‰‡ï¼Œè„šæœ¬æ–‡ä»¶)ä¹‹åè§¦å‘

`DOMContentload`å’Œ`script`ä¹‹é—´å…³ç³»ã€‚

åœ¨[(no defer async)script.html](https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/script.html)ä¸­ï¼Œå°†`script`æ”¾åœ¨ç»“å°¾æµ‹è¯•ï¼Œæ­¤æ—¶è„šæœ¬ä¸‹è½½ä¸å¹²æ‰°`dom`è§£æï¼›å°†`script`æ”¾åœ¨å¤´éƒ¨[(no defer async)normal-scriptä½ç½®æµ‹è¯•.html](https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/normal-script%E9%A1%B5%E9%9D%A2%E4%BD%8D%E7%BD%AE%E6%B5%8B%E8%AF%95.html)ï¼Œä¼šå¹²æ‰°domè§£æã€‚è™½ç„¶ä¸¤ä¸ªéƒ½æ˜¯åœ¨JSè„šæœ¬å®Œæˆä¹‹åå†è§¦å‘`DOMContentload`(`DOMContentload`è§¦å‘æ—¶å¯ä»¥æ‰“å°å‡º`windows.$`)ã€‚ä½†æ˜¯å®é™…æƒ…å†µæœ‰æ‰€ä¸åŒï¼Œå‰è€…ç™½å±æ—¶é—´æ¯”è¾ƒçŸ­ã€‚

ç”±äº`defer`çš„ç‰¹æ€§åœ¨äºä¸” **åœ¨`DOMCONTENTLOAD`ä¹‹å‰æ‰§è¡Œï¼Œä¸”ä¸‹è½½çš„æ—¶å€™ä¸å¹²æ‰°domè§£æï¼Œå› æ­¤æ”¾åœ¨é‚£é‡Œä½ç½®éƒ½æ˜¯å¯ä»¥çš„ã€‚** è§[(è°ƒæ•´ç½‘ç»œä¸ºslow-3g)defer-scriptä½ç½®æµ‹è¯•.html](https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/defer-script%E9%A1%B5%E9%9D%A2%E4%BD%8D%E7%BD%AE%E6%B5%8B%E8%AF%95.html)å’Œ[(è°ƒæ•´ç½‘ç»œä¸ºslow-3g)async-scriptä½ç½®æµ‹è¯•.html](https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/async-script%E9%A1%B5%E9%9D%A2%E4%BD%8D%E7%BD%AE%E6%B5%8B%E8%AF%95.html)æµ‹è¯•ï¼Œæ— è®º`defer`åœ¨å¼€å¤´è¿˜æ˜¯ç»“å°¾(`DOMContentload`è§¦å‘æ—¶å¯ä»¥æ‰“å°å‡º`windows.$`)

ç»¼åˆ`normal and defer script`æµ‹è¯•å¯ä»¥å¾—åˆ°ç»“è®ºï¼š

- å¯ä»¥å‘ç°`DOMCONTENTLOAD`ç­‰å¾…`normal script`æ˜¯å› ä¸ºæ¸²æŸ“ç‰¹æ€§ï¼Œç­‰å¾…`defer`æ˜¯å› ä¸ºå…¶è§„å®šåœ¨`DOMCONTENTLOAD`ä¹‹å‰æ‰§è¡Œã€‚

- å¯ä»¥å‘ç°å†™åœ¨æœ€åå¯ä»¥å‘ç°æœ‰æ— `defer`ç»“æœè¡¨ç°ä¸€è‡´ï¼Œè¿™å’Œç°ä»£æµè§ˆå™¨å¹¶è¡Œä¸‹è½½`script`æœ‰å…³ã€‚  

å¯¹äº`async`ï¼Œåœ¨[(è°ƒæ•´ç½‘ç»œä¸ºslow-3g)defer-scriptä½ç½®æµ‹è¯•.html](https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/defer-script%E9%A1%B5%E9%9D%A2%E4%BD%8D%E7%BD%AE%E6%B5%8B%E8%AF%95.html)å’Œ[(è°ƒæ•´ç½‘ç»œä¸ºslow-3g)async-scriptä½ç½®æµ‹è¯•.html](https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/async-script%E9%A1%B5%E9%9D%A2%E4%BD%8D%E7%BD%AE%E6%B5%8B%E8%AF%95.html)æµ‹è¯•å‘ç°æœ‰æ‰€ **ä¸åŒ**(`DOMContentload`è§¦å‘æ—¶æ— æ³•æ‰“å°å‡º`windows.$`)ã€‚è¯´æ˜:

- `async`ä¸ä¼šä¸¥æ ¼ç­‰å¾…`DOMCONTENTLOAD`ä¹‹å‰æ‰§è¡Œï¼Œ`DOMCONTENTLOAD`ä¹Ÿä¸ä¼šå› ä¸º`async JS`æ–‡ä»¶æ²¡æœ‰ä¸‹è½½å®Œå°±ä¸è§¦å‘ã€‚**å–å†³äºasync æ˜¯å¦èƒ½å¤Ÿ`DOMCONTENTLOAD`è§¦å‘æ—¶å€™ä¸‹è½½å®Œæˆ** åœ¨ä¸Šé¢ä¸¤ä¸ªä¾‹å­ç”±äº`JS`æ–‡ä»¶æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥åœ¨`DOMCONTENTLOAD`ä¹‹å‰å¹¶æ²¡æœ‰ä¸‹è½½å®Œå…¨ã€‚
- å¦‚æœæ¯”è¾ƒå°çš„æ–‡ä»¶ï¼Œå¯èƒ½ä¼šåœ¨`DOMCONTENTLOAD`ä¹‹å‰å®Œæˆ

> **ğŸ’¡ NOTE**  
ç”±äºDOMContentloadä¸CSSæ— å…³ï¼Œæ‰€ä»¥æ­¤æ—¶`DOMContentload`è§¦å‘çš„æ—¶å€™å¹¶ä¸ä¸€å®šä¼šå‡ºç°é¡µé¢

## æµè§ˆå™¨æ¸²æŸ“æµç¨‹

![æ¸²æŸ“æµç¨‹å›¾](/docs/Broswer/img/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93%E5%8E%9F%E7%90%86.png)

ä¸Šå›¾è¡¨æ˜äº†`html&css&js`éƒ½ä¼šæ”¹å˜`dom`ã€‚ç”±ä»¥ä¸Šå¯ä»¥å¾—åˆ°ç»“è®º

1. `CSS - CSSDOM`ä¸‹è½½æ„å»ºä¸ä¼šå½±å“`HTMLDOM`æ„å»ºï¼Œä½†æ˜¯åªæœ‰`CSSDOM and HTMLDOM`å…¨éƒ¨å®Œæˆä¹‹åæ‰ä¼šå‘ˆç°é¡µé¢(è¿™éƒ¨åˆ†å«æ¸²æŸ“)ã€‚åŒæ—¶å¦‚æœ`CSS`æ–‡ä»¶åé¢å¦‚æœæœ‰`JS`è„šæœ¬ï¼Œ`JS`è„šæœ¬éœ€è¦ç­‰å¾…`CSSDOM`ä¸‹è½½æˆ–è€…è§£æã€‚
2. `HTML - HTMLDOM`
3. `JS - DOMAPI`ä¼šå½±å“åˆ°`CSSDOM`ä»¥åŠ`HTMLDOM`ã€‚æ‰€ä»¥å¦‚æœ`JS`å†™åœ¨`CSS or HTML`ä¹‹å‰ï¼Œå°±ä¼šå¹²æ‰°`CSS or HTML`ä»»ä½•ä¸€ä¸ªè¿‡ç¨‹[Q&A2]()ï¼Œæ‰€ä»¥ä¸€èˆ¬å°†æ–‡ä»¶æ”¾åœ¨é¡µé¢æœ€ä¸‹æ–¹ã€‚

**é¢˜å¤–è¯**

å¦‚æœå°†`JS`ä»£ç å†™åœ¨`HTML`ç»“æ„ä¸­ã€‚`HTML`è§£æä¸­é‡åˆ°äº†`script`æ ‡ç­¾ï¼Œæµè§ˆå™¨ä¼š **ä¸‹è½½ä»¥åŠæ‰§è¡Œ** æ‰§è¡Œ`script`æ ‡ç­¾ä¸­çš„`JS`ä»£ç ã€‚

**æ‰€ä»¥å¹¶ä¸æ˜¯åŒæ­¥è¿›è¡Œï¼Œä¹¦å†™é¡ºåºååˆ†é‡è¦**

å…¶ä¸­å‰ä¸¤ä¸ªä¼šæ„é€ `DOM TREE`ï¼Œå…¶ä¸­`CSS`æ˜¯`CSS DOM TREE`ï¼Œ`HTML`æ˜¯`HTML DOM TREE`ã€‚**è¿™ä¸‰ä¸ªéƒ½ä¼šä½œç”¨é¡µé¢æ ·å¼å¸ƒå±€**ï¼Œå…¶é¡ºåºå¦‚ä½•ï¼Ÿæœ‰ä»¥ä¸‹å‡ ä¸ªè§„åˆ™ï¼š

### å‡è®¾æ²¡æœ‰SCRIPT

* `CSS`æ„å»º`CSSDOM` - å¯¹äº`link`æ ‡ç­¾æ¥è¯´ï¼Œå…¶ä¸‹è½½è¿‡ç¨‹ä¸ä¼šå¹²æ‰°`DOM`è§£æ(å› ä¸º`CSS`æ–‡ä»¶æ²¡æœ‰ä¿®æ”¹æ·»åŠ æˆ–åˆ é™¤é¡µé¢æ ‡ç­¾çš„èƒ½åŠ›ï¼Œæ‰€ä»¥æ„å»º`HTMLDOM`çš„æ—¶å€™ä¹Ÿä¸ä¼š)ï¼ŒåŒç†è‡ªç„¶æ„å»º`CSSDOM`çš„è¿‡ç¨‹ä¹Ÿæ˜¯ä¸ä¼šã€‚
* ç”±äº`CSS`æ–‡ä»¶ä¸‹è½½(or æ„å»º)ä¸å¹²æ‰°è§£æ`HTML`ç»“æ„ï¼Œ`HTML`ç»“æ„åŒæ­¥åœ¨æ„å»ºçš„è¿‡ç¨‹ä¸­ã€‚

**æ³¨æ„ï¼šè™½ç„¶ä¸é˜»å¡æ„å»ºï¼Œä½†æ˜¯ä¼šå½±å“æ¸²æŸ“**

`HTML DOM`æ„å»ºå®Œæˆä¹‹åï¼Œé¡µé¢å¹¶ä¸ä¼šå‘ˆç°ã€‚å› ä¸ºæ­¤æ—¶`CSS`æ–‡ä»¶å¯èƒ½è¿˜å¤„äºä¸‹è½½ä»¥åŠæ„å»ºè¿‡ç¨‹ä¸­ã€‚å½“`CSS and HTML`éƒ½å®Œæˆäº†ï¼Œé¡µé¢å°±ä¼šå‘ˆç°ã€‚

### scriptçš„æ‰§è¡Œé¡ºåº

`script`æ–‡ä»¶ä¸­å¯èƒ½å«æœ‰å¯¹`DOM`ç»“æ„æ“ä½œ(å¯èƒ½æ˜¯é€šè¿‡æ ‡ç­¾æˆ–è®¸æ˜¯é€šè¿‡classï¼Œä»¥åŠå¯èƒ½è¦è·å–æ ·å¼)

**åŒæ­¥&å¼‚æ­¥**ï¼Œå¯¹äº`script`è„šæœ¬æ¥è¯´éœ€è¦è€ƒè™‘åŒæ­¥å¼‚æ­¥ï¼Œåˆ†åˆ«æ˜¯åŠ è½½ä»¥åŠæ‰§è¡Œçš„åŒæ­¥å¼‚æ­¥ã€‚è¿™é‡Œåªè€ƒè™‘åŠ è½½çš„åŒæ­¥æˆ–è€…å¼‚æ­¥å¯¹äºæ‰§è¡Œç»“æœçš„å½±å“ã€‚

å¯¹äºåŒæ­¥åŠ è½½çš„æ ‡ç­¾ï¼Œå‡è®¾`script`æ ‡ç­¾æ²¡æœ‰`defer or async`ï¼Œé‚£ä¹ˆåœ¨åŠ è½½è¿‡ç¨‹ä¼šé˜»å¡`css or html`ä»»ä½•è¿‡ç¨‹ã€‚æ‰€ä»¥`script`æ ‡ç­¾ä¸€èˆ¬ä¹Ÿæ˜¯æ”¾åœ¨æœ€åï¼Œä¿è¯`CSSDOM and HTMLDOM`å…ˆäº`script`ã€‚

å¯¹äºå¼‚æ­¥åŠ è½½çš„æ ‡ç­¾ï¼Œ`async`åŠ è½½æ—¶å€™ä¸ä¼šé˜»å¡ï¼Œä½†æ˜¯æ‰§è¡Œæ—¶å€™ä¼šï¼Œä¸”å’Œ`normal`ä¸ä¼šç­‰å¾…`htmldom`ã€‚æ‰€ä»¥å¯ä»¥æ”¾åœ¨å¤´éƒ¨ï¼Œä½†æ˜¯ä¸åº”è¯¥æœ‰æ“ä½œ`css`çš„ä»£ç ï¼›å¦‚æœæ”¾åœ¨å°¾éƒ¨ï¼Œè¡¨ç°å’Œ`normal`ä¸€è‡´ã€‚

å¯¹äºå¼‚æ­¥åŠ è½½çš„æ ‡ç­¾ï¼Œ`defer`åŠ è½½æ—¶å€™ä¸ä¼šé˜»å¡ï¼Œä½†æ˜¯æ‰§è¡Œæ—¶å€™ä¼šç­‰å¾…`htmldom`ã€‚æ‰€ä»¥å¯ä»¥æ”¾åœ¨ä»»ä½•ä½ç½®ã€‚

ä¸è¿‡æ­¤æ—¶éœ€è¦è€ƒè™‘[Q&A - CSSå’ŒJSæ–‡ä»¶å…ˆåé—®é¢˜]()ï¼ŒJSåªä¼šç­‰å¾…å‰é¢`CSS`æ–‡ä»¶ã€‚

## QA

1. **å¦‚æœJSä¸‹è½½å®Œæˆï¼Œæ‰§è¡Œæ—¶é—´æ¯”è¾ƒé•¿ï¼Œä¼šå½±å“domå—ï¼Ÿ**

    å¦‚åŒä¹‹å‰æ€»è®¡çš„`cssdom htmldom`éƒ½å®Œæˆäº†ï¼Œåˆå§‹é¡µé¢å°±å·²ç»å¯ä»¥çœ‹åˆ°äº†ã€‚

    (æˆ‘è§‰å¾—å¯èƒ½æ˜¯å› ä¸º)è¿™é‡Œæœ‰ä¸€ä¸ªå°ç»†èŠ‚ï¼Œå¦‚æœ`script`åœ¨`cssdom or htmldom`è§£æå®Œæˆä¹‹åä¹Ÿå®Œæˆäº†ä¸‹è½½ï¼Œä¸”æ‰§è¡Œæ—¶é—´æ¯”è¾ƒä¹…çš„è¯ã€‚å¯èƒ½ä¼šå‡ºç°ç™½å±çš„æƒ…å†µï¼Œå°±åƒæ˜¯[longtimescript.html](https://github.com/JiangWeixian/JS-Tips/blob/master/docs/Broswer/HTML/longtimescript.html)é‚£æ ·ã€‚**å¹²æ‰°é¡µé¢å‘ˆç°**

2. **JSå’ŒCSSä¹¦å†™é¡ºåºï¼ŒåŒæ­¥å¼‚æ­¥å…³ç³»**

    å¦‚æœ`JS`å‰é¢å­˜åœ¨`CSS`æ–‡ä»¶æ‰ä¼šç­‰å¾…å‰é¢çš„`CSS`æ–‡ä»¶ä¸‹è½½æ„å»ºï¼Œè€Œä¸ä¼šç­‰å¾…åé¢`CSS`æ–‡ä»¶ã€‚

3. **`defer or async`JSå’ŒCSSä¹¦å†™é¡ºåºï¼ŒåŒæ­¥å¼‚æ­¥å…³ç³»**

4. **normal and defer or asyncä¸‹è½½çš„å½±å“**

    æˆ‘ä»¬çŸ¥é“`defer or async`ä¸‹è½½è¿‡ç¨‹å¯¹`dom`è§£æä¸å—åˆ°å½±å“ã€‚é‚£ä¹ˆå¦‚æœåœ¨`cssdom htmldom`è§£æå®Œæˆä¹‹åï¼Œ`js`ä»æ—§æ²¡æœ‰ä¸‹è½½å®Œï¼Ÿé‚£ä¹ˆé¡µé¢è¿˜ä¼šå‡ºç°å—ï¼Ÿ

    åœ¨[å‚è€ƒé“¾æ¥](https://juejin.im/post/59c60691518825396f4f71a1) å­˜åœ¨ä¸€ä¸ª`script`åœ¨`cssdom htmldom`éƒ½å®Œæˆäº†ä¹‹åï¼Œè¿˜æ˜¯å¤„äºä¸‹è½½è¿‡ç¨‹ä¸­ã€‚æ­¤æ—¶é¡µé¢å‡ºç°ï¼Œå•ç­‰åˆ°è¯¥`script`ä¸‹è½½å®Œæˆï¼Œå¹¶æ‰§è¡Œï¼Œå¯èƒ½ä¼šè®©åŸå…ˆé¡µé¢æœ‰é—ªç¡•ã€‚å› ä¸ºè„šæœ¬æ–‡ä»¶ä¸­å¯èƒ½å«æœ‰ä¿®æ”¹æ ·å¼çš„ä»£ç ã€‚

    è¿™ä¸€ç‚¹å’Œ`defer normal async`çš„å±æ€§æ— å…³ã€‚

5. **defer or asyncä¸‹è½½æ˜¯å¦ä¼šå½±å“å…¶ä»–èµ„æºä¸‹è½½**

    ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬åªä¼šæåˆ°`defer async`ä¸ä¼šå¹²æ‰°`dom`è§£æï¼Œä¸”ä¼šå¹¶è¡Œä¸‹è½½ã€‚ä½†æ˜¯ä¸‹è½½çš„æ—¶å€™æ˜¯å¦ä¼šå½±å“å…¶ä»–èµ„æºä¸‹è½½ï¼Ÿè¿™å–å†³äºæµè§ˆå™¨æ”¯æŒå¤šå°‘ä¸ªèµ„æºå¹¶è¡Œä¸‹è½½ï¼Œå¯èƒ½ä¼šå½±å“ï¼Œä¹Ÿå¯èƒ½ä¸ä¼šã€‚

### å†·çŸ¥è¯†

**æ³¨æ„0: - ä¸€èˆ¬å°†deferè„šæœ¬æ”¾åœ¨æœ€åæ˜¯ä¸ºäº†å…¼å®¹ie**

**æ³¨æ„1 - ç°ä»£æµè§ˆå™¨å·²ç»æ”¯æŒçš„æ˜¯å¹¶è¡Œä¸‹è½½scriptèµ„æº(åœ¨æ²¡æœ‰è®¾ç½®ä»¥ä¸Šæƒ…å†µä¸‹)ï¼Œä½†æ˜¯åœ¨ä¸å¼€å¯`defer or async`ä¼šå¹²æ‰°å…¶ä»–èµ„æºä¸‹è½½**ã€‚

**æ³¨æ„2 - chromeè°ƒè¯•å·¥å…·å¯ä»¥çœ‹åˆ°initatoråˆ¤æ–­æ˜¯è°å‘èµ·äº†jsè¯·æ±‚ã€‚æ¥è‡ªscriptæ ‡ç­¾è¯´æ˜æ˜¯åŠ¨æ€æ·»åŠ äº†è„šæœ¬**ã€‚å¦‚æœæ˜¯æ¥è‡ª`parser`å°±æ˜¯ç›´æ¥å†™åœ¨htmlé‡Œé¢çš„ã€‚å¯ä»¥[async&defer](https://github.com/JiangWeixian/JS-Tips/tree/master/demos/async%26defer)çš„ä¾‹å­ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¯ä»¥å¾—åˆ°ï¼š

0. åŠ¨æ€æ·»åŠ çš„è„šæœ¬ï¼Œé»˜è®¤å¼€`async`
1. å¦‚æœhtmlæ–‡ä»¶å¾ˆå°ï¼Œdefer asyncè„šæœ¬å¼€å§‹åŠ è½½çš„äº‹ä»¶ç›¸åŒã€‚ä½†æ˜¯`async`æ‰§è¡Œè¦æ»ååœ¨`defer`ä¹‹åã€‚è‡³å°‘åœ¨`chrome`é‡Œé¢æ˜¯è¿™æ ·çš„ã€‚
2. è€ŒåŠ¨æ€æ·»åŠ çš„è„šæœ¬ **å¼€å§‹åŠ è½½çš„æ—¶é—´**ä¸€èˆ¬æ˜¯åœ¨`defer async or other`æ­¤ç±»å†™æ­»åœ¨`html`è„šæœ¬ä¹‹åçš„ã€‚

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ[çŸ¥ä¹-æŸç­”æ¡ˆnetworkä¸­jsåŠ è½½æ—¶é—´asyncå»¶ådeferé‚£ä¹ˆå¤š](https://www.zhihu.com/question/20531965)

## æ¸²æŸ“é‡æ–°å¼€å§‹

å½“`CSS-DOM-TREE&HTML-DOM-TREE`ç»„åˆå®Œæˆå¼€å§‹æ¸²æŸ“ã€‚

å…¶å®é‡åˆ°äº†`JS`æ–‡ä»¶ï¼Œå¦‚æœå…¶ä¸­æ”¹å˜äº†`HTML-DOM-TREE`æˆ–è€…æ˜¯`CSS-DOM-TREE`ã€‚å°±ä¸å¾—ä¸é‡æ–°æ¸²æŸ“ï¼

æ¸²æŸ“çš„ç¨‹åº¦å–å†³äº`JS`å¯¹`DOM`æ”¹å˜ç¨‹åº¦ï¼Œæœ‰å¯èƒ½æ˜¯éƒ¨åˆ†ï¼Œæœ‰å¯èƒ½æ˜¯å…¨éƒ¨ã€‚

## ä¼˜åŒ–

1. å°†`script`æ ‡ç­¾å†™åˆ°é¡µé¢æœ€åæ˜¯ä¼˜åŒ–æ‰‹æ®µä¹‹ä¸€ 
2. `defer & async`å±æ€§
    > å…±åŒç‰¹ç‚¹ - åŠ è½½`JS`çš„æ—¶å€™ **ä¸å¹²æ‰°HTML(è§£æ)ï¼Œä½†æ˜¯è¿è¡Œçš„æ—¶å€™è¿˜æ˜¯ä¼š**
3. `defer` - å»¶è¿Ÿã€‚
    * å¹¶åœ¨`HTML-DOM-TREE`è§£æå®Œæ¯•(ä¸€ä¸ªå«`DOMContentLoaded`äº‹ä»¶ï¼Œåœ¨[å‰ç½®çŸ¥è¯†ä¸­æœ‰è§£æ]())ä¹‹å‰ï¼Œä¸”`JS`åŠ è½½å®Œæ¯•ä¹‹åæ‰§è¡Œ(è¿˜è¦å—åˆ°[Q&A3]()æåˆ°çš„ç­‰å¾…å‰é¢çš„`CSSDOM`)
    * æ‰€ä»¥ä¸¤ä¸ªdeferè„šæœ¬çš„æ‰§è¡Œé¡ºåºæ˜¯å¯ä»¥ä¿è¯çš„ã€‚æŒ‰ä¹¦å†™é¡ºåºã€‚
4. `async` - åŒæ­¥ã€‚
    * ä½†æ˜¯æ˜¯åœ¨ **async-JSåŠ è½½å®Œæ¯•ä¹‹å** æ‰§è¡Œ(æ‰§è¡Œçš„æ—¶å€™è¿˜æ˜¯å¹²æ‰°äº†domï¼Œä¸`HTML-DOM-TREE`è§£æå®Œæ¯•æ— å…³)ã€‚
    * **æœ€å¥½ä¸ä¾èµ–å…¶ä»–è„šæœ¬**ã€‚
    * ä¸¤ä¸ª`async`è„šæœ¬çš„æ‰§è¡Œé¡ºåºæ— æ³•ä¿è¯ã€‚

**defer async domcontentloadä¹‹é—´è”ç³»**

è§[domcontentload]()å°ç»“åˆ†æã€‚

> å¤§è‡´æ¥è¯´ï¼Œä¹Ÿå°±æ˜¯è¯´`async`å¯èƒ½åœ¨`defer`ä¹‹å‰æˆ–è€…ä¹‹åéƒ½æœ‰å¯èƒ½ã€‚`async`åœ¨`DOMContentLoaded`å‘ç”Ÿä¹‹å‰ä¹‹åéƒ½æœ‰å¯èƒ½ã€‚

## é“¾æ¥

* [ç®€å•ç†è§£](http://www.cnblogs.com/Peng2014/p/4687218.html)
* [ååˆ†ç»†è‡´çš„è§£æ](https://www.jianshu.com/p/a32b890c29b1)
* [æåˆ°JSç­‰å¾…CSS](https://www.w3cplus.com/javascript/building-the-dom-faster-speculative-parsing-async-defer-and-preload.html)
* [CSSå’ŒJS&DOMå¤§é‡æµ‹è¯•](https://juejin.im/post/59c60691518825396f4f71a1)
* [å…³äºdomcontentload](https://zhuanlan.zhihu.com/p/25876048)